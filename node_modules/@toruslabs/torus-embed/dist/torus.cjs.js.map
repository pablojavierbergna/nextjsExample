{"version":3,"file":"torus.cjs.js","mappings":"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","sources":["webpack://@toruslabs/torus-embed/webpack/bootstrap","webpack://@toruslabs/torus-embed/webpack/runtime/compat get default export","webpack://@toruslabs/torus-embed/webpack/runtime/define property getters","webpack://@toruslabs/torus-embed/webpack/runtime/hasOwnProperty shorthand","webpack://@toruslabs/torus-embed/external commonjs2 \"@babel/runtime/helpers/objectWithoutProperties\"","webpack://@toruslabs/torus-embed/external commonjs2 \"@babel/runtime/helpers/defineProperty\"","webpack://@toruslabs/torus-embed/external commonjs2 \"@toruslabs/fetch-node-details\"","webpack://@toruslabs/torus-embed/external commonjs2 \"@toruslabs/http-helpers\"","webpack://@toruslabs/torus-embed/external commonjs2 \"@toruslabs/openlogin-jrpc\"","webpack://@toruslabs/torus-embed/external commonjs2 \"@toruslabs/torus.js\"","webpack://@toruslabs/torus-embed/external commonjs2 \"lodash.merge\"","webpack://@toruslabs/torus-embed/./src/interfaces.ts","webpack://@toruslabs/torus-embed/./src/supportedCurrencies.ts","webpack://@toruslabs/torus-embed/./src/config.ts","webpack://@toruslabs/torus-embed/./src/embedUtils.ts","webpack://@toruslabs/torus-embed/external commonjs2 \"@metamask/obs-store\"","webpack://@toruslabs/torus-embed/external commonjs2 \"eth-rpc-errors\"","webpack://@toruslabs/torus-embed/external commonjs2 \"fast-deep-equal\"","webpack://@toruslabs/torus-embed/external commonjs2 \"is-stream\"","webpack://@toruslabs/torus-embed/external commonjs2 \"pump\"","webpack://@toruslabs/torus-embed/external commonjs2 \"loglevel\"","webpack://@toruslabs/torus-embed/./src/loglevel.ts","webpack://@toruslabs/torus-embed/./src/messages.ts","webpack://@toruslabs/torus-embed/./src/utils.ts","webpack://@toruslabs/torus-embed/./src/inpage-provider.ts","webpack://@toruslabs/torus-embed/external commonjs2 \"create-hash\"","webpack://@toruslabs/torus-embed/./src/integrity.ts","webpack://@toruslabs/torus-embed/external commonjs2 \"events\"","webpack://@toruslabs/torus-embed/./src/PopupHandler.ts","webpack://@toruslabs/torus-embed/./src/siteMetadata.ts","webpack://@toruslabs/torus-embed/./src/embed.ts","webpack://@toruslabs/torus-embed/./src/index.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/objectWithoutProperties\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/defineProperty\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@toruslabs/fetch-node-details\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@toruslabs/http-helpers\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@toruslabs/openlogin-jrpc\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@toruslabs/torus.js\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"lodash.merge\");","import { JRPCId, JRPCMiddleware, JRPCRequest, JRPCVersion, SafeEventEmitter } from \"@toruslabs/openlogin-jrpc\";\nimport createHash from \"create-hash\";\nimport type { Duplex } from \"readable-stream\";\n\nexport const LOGIN_PROVIDER = {\n  GOOGLE: \"google\",\n  FACEBOOK: \"facebook\",\n  TWITCH: \"twitch\",\n  REDDIT: \"reddit\",\n  DISCORD: \"discord\",\n} as const;\n\nexport const WALLET_VERIFIERS = {\n  GOOGLE: \"google\",\n  FACEBOOK: \"facebook\",\n  TWITCH: \"twitch\",\n  REDDIT: \"reddit\",\n  DISCORD: \"discord\",\n  EMAIL_PASSWORDLESS: \"torus-auth0-email-passwordless\",\n} as const;\n\nexport const WALLET_OPENLOGIN_VERIFIER_MAP = {\n  [WALLET_VERIFIERS.GOOGLE]: \"tkey-google\",\n  [WALLET_VERIFIERS.FACEBOOK]: \"tkey-facebook\",\n  [WALLET_VERIFIERS.TWITCH]: \"tkey-twitch\",\n  [WALLET_VERIFIERS.REDDIT]: \"tkey-reddit\",\n  [WALLET_VERIFIERS.DISCORD]: \"tkey-discord\",\n  [WALLET_VERIFIERS.EMAIL_PASSWORDLESS]: \"tkey-auth0-email-passwordless\",\n} as const;\n\nexport const PAYMENT_PROVIDER = {\n  MOONPAY: \"moonpay\",\n  WYRE: \"wyre\",\n  RAMPNETWORK: \"rampnetwork\",\n  XANPOOL: \"xanpool\",\n  MERCURYO: \"mercuryo\",\n  TRANSAK: \"transak\",\n} as const;\n\nexport const SUPPORTED_PAYMENT_NETWORK = {\n  MAINNET: \"mainnet\",\n  MATIC: \"matic\",\n  BSC_MAINNET: \"bsc_mainnet\",\n  AVALANCHE_MAINNET: \"avalanche_mainnet\",\n  XDAI: \"xdai\",\n} as const;\n\nexport const TORUS_BUILD_ENV = {\n  PRODUCTION: \"production\",\n  DEVELOPMENT: \"development\",\n  BINANCE: \"binance\",\n  TESTING: \"testing\",\n  LRC: \"lrc\",\n  BETA: \"beta\",\n} as const;\n\nexport type PAYMENT_PROVIDER_TYPE = typeof PAYMENT_PROVIDER[keyof typeof PAYMENT_PROVIDER];\n\nexport type SUPPORTED_PAYMENT_NETWORK_TYPE = typeof SUPPORTED_PAYMENT_NETWORK[keyof typeof SUPPORTED_PAYMENT_NETWORK];\n\nexport type TORUS_BUILD_ENV_TYPE = typeof TORUS_BUILD_ENV[keyof typeof TORUS_BUILD_ENV];\n\nexport interface IPaymentProvider {\n  line1: string;\n  line2: string;\n  line3: string;\n  supportPage: string;\n  minOrderValue: number;\n  maxOrderValue: number;\n  validCurrencies: string[];\n  validCryptoCurrenciesByChain: Partial<Record<string, { value: string; display: string }[]>>;\n  includeFees: boolean;\n  enforceMax: boolean;\n  sell?: boolean;\n}\n\nexport interface IHashAlgorithmOptions {\n  algorithms?: createHash.algorithm[];\n  delimiter?: string;\n  full?: boolean;\n}\n\nexport interface SRI {\n  hashes: Record<createHash.algorithm, string>;\n  integrity?: string;\n}\n\nexport const BUTTON_POSITION = {\n  BOTTOM_LEFT: \"bottom-left\",\n  TOP_LEFT: \"top-left\",\n  BOTTOM_RIGHT: \"bottom-right\",\n  TOP_RIGHT: \"top-right\",\n} as const;\n\nexport type EMBED_TRANSLATION_ITEM = {\n  continue: string;\n  actionRequired: string;\n  pendingAction: string;\n  cookiesRequired: string;\n  enableCookies: string;\n  clickHere: string;\n};\n\nexport type BUTTON_POSITION_TYPE = typeof BUTTON_POSITION[keyof typeof BUTTON_POSITION];\n\nexport type WALLET_PATH = \"transfer\" | \"topup\" | \"home\" | \"settings\" | \"history\" | \"discover\";\nexport type ETHEREUM_NETWORK_TYPE =\n  | \"ropsten\"\n  | \"rinkeby\"\n  | \"kovan\"\n  | \"mainnet\"\n  | \"goerli\"\n  | \"localhost\"\n  | \"matic\"\n  | \"mumbai\"\n  | \"xdai\"\n  | \"bsc_mainnet\"\n  | \"bsc_testnet\";\n\nexport type LOGIN_TYPE =\n  | \"google\"\n  | \"facebook\"\n  | \"reddit\"\n  | \"discord\"\n  | \"twitch\"\n  | \"apple\"\n  | \"github\"\n  | \"linkedin\"\n  | \"twitter\"\n  | \"weibo\"\n  | \"line\"\n  | \"jwt\"\n  | \"email_password\"\n  | \"passwordless\";\n\nexport interface TorusCtorArgs {\n  /**\n   * Determines where the torus widget is visible on the page.\n   * @defaultValue bottom-left\n   */\n  buttonPosition?: BUTTON_POSITION_TYPE;\n\n  /**\n   * Z-index of the modal and iframe\n   * @defaultValue 99999\n   */\n  modalZIndex?: number;\n\n  /**\n   * Api key\n   * Get yours today at {@link https://developer.tor.us | Dashboard}\n   */\n  apiKey?: string;\n}\n\nexport interface TorusLoginParams {\n  verifier?: string;\n  login_hint?: string;\n}\n\nexport interface NetworkInterface {\n  /**\n   * If any network other than the ones in enum, it should a JSON RPC URL\n   */\n  host: ETHEREUM_NETWORK_TYPE | string;\n  /**\n   * chainId for the network. If not provided, we query the host\n   */\n  chainId?: number;\n  /**\n   * Name of the network\n   */\n  networkName?: string;\n  /**\n   * Url of the block explorer\n   */\n  blockExplorer?: string;\n  /**\n   * Default currency ticker of the network (e.g: BNB)\n   */\n  ticker?: string;\n  /**\n   * Name for currency ticker (e.g: `Binance Coin`)\n   */\n  tickerName?: string;\n}\n\nexport interface BaseLoginOptions {\n  /**\n   * If you need to send custom parameters to the Authorization Server,\n   * make sure to use the original parameter name.\n   */\n  [key: string]: unknown;\n  /**\n   * - `'page'`: displays the UI with a full page view\n   * - `'popup'`: displays the UI with a popup window\n   * - `'touch'`: displays the UI in a way that leverages a touch interface\n   * - `'wap'`: displays the UI with a \"feature phone\" type interface\n   */\n  display?: \"page\" | \"popup\" | \"touch\" | \"wap\";\n  /**\n   * - `'none'`: do not prompt user for login or consent on reauthentication\n   * - `'login'`: prompt user for reauthentication\n   * - `'consent'`: prompt user for consent before processing request\n   * - `'select_account'`: prompt user to select an account\n   */\n  prompt?: \"none\" | \"login\" | \"consent\" | \"select_account\";\n  /**\n   * Maximum allowable elasped time (in seconds) since authentication.\n   * If the last time the user authenticated is greater than this value,\n   * the user must be reauthenticated.\n   */\n  max_age?: string | number;\n  /**\n   * The space-separated list of language tags, ordered by preference.\n   * For example: `'fr-CA fr en'`.\n   */\n  ui_locales?: string;\n  /**\n   * Previously issued ID Token.\n   */\n  id_token_hint?: string;\n  /**\n   * The user's email address or other identifier. When your app knows\n   * which user is trying to authenticate, you can provide this parameter\n   * to pre-fill the email box or select the right session for sign-in.\n   *\n   * This currently only affects the classic Lock experience.\n   */\n  login_hint?: string;\n  acr_values?: string;\n  /**\n   * The default scope to be used on authentication requests.\n   * The defaultScope defined in the Auth0Client is included\n   * along with this scope\n   */\n  scope?: string;\n  /**\n   * The default audience to be used for requesting API access.\n   */\n  audience?: string;\n  /**\n   * The name of the connection configured for your application.\n   * If null, it will redirect to the Auth0 Login Page and show\n   * the Login Widget.\n   */\n  connection?: string;\n}\n\nexport interface JwtParameters extends BaseLoginOptions {\n  /**\n   * Your Auth0 account domain such as `'example.auth0.com'`,\n   * `'example.eu.auth0.com'` or , `'example.mycompany.com'`\n   * (when using [custom domains](https://auth0.com/docs/custom-domains))\n   */\n  domain: string;\n  /**\n   * The Client ID found on your Application settings page\n   */\n  client_id?: string;\n  /**\n   * The default URL where Auth0 will redirect your browser to with\n   * the authentication result. It must be whitelisted in\n   * the \"Allowed Callback URLs\" field in your Auth0 Application's\n   * settings. If not provided here, it should be provided in the other\n   * methods that provide authentication.\n   */\n  redirect_uri?: string;\n  /**\n   * The value in seconds used to account for clock skew in JWT expirations.\n   * Typically, this value is no more than a minute or two at maximum.\n   * Defaults to 60s.\n   */\n  leeway?: number;\n\n  /**\n   * The field in jwt token which maps to verifier id\n   */\n  verifierIdField?: string;\n\n  /**\n   * Whether the verifier id field is case sensitive\n   * @defaultValue true\n   */\n  isVerifierIdCaseSensitive?: boolean;\n}\n\nexport interface LoginConfigItem {\n  /**\n   * Display Name. If not provided, we use the default for torus app\n   */\n  name: string;\n  /**\n   * The type of login. Refer to enum `LOGIN_TYPE`\n   */\n  typeOfLogin: LOGIN_TYPE;\n  /**\n   * Description for button. If provided, it renders as a full length button. else, icon button\n   */\n  description?: string;\n  /**\n   * Custom client_id. If not provided, we use the default for torus app\n   */\n  clientId?: string;\n  /**\n   * Logo to be shown on mouse hover. If not provided, we use the default for torus app\n   */\n  logoHover?: string;\n  /**\n   * Logo to be shown on dark background (dark theme). If not provided, we use the default for torus app\n   */\n  logoLight?: string;\n  /**\n   * Logo to be shown on light background (light theme). If not provided, we use the default for torus app\n   */\n  logoDark?: string;\n  /**\n   * Whether to show the login button on modal or not\n   */\n  showOnModal?: boolean;\n  /**\n   * Whether to show the login button on mobile\n   */\n  showOnMobile?: boolean;\n  /**\n   * Custom jwt parameters to configure the login. Useful for Auth0 configuration\n   */\n  jwtParameters?: JwtParameters;\n  /**\n   * Show login button on the main list\n   */\n  mainOption?: boolean;\n  /**\n   * Whether to show the login button on desktop\n   */\n  showOnDesktop?: boolean;\n  /**\n   * Modify the order of buttons. Should be greater than zero, where 1 is top priority.\n   */\n  priority?: number;\n}\n\nexport interface LoginConfig {\n  /**\n   * Use the verifier provided by torus as a key or a default verifier used by torus\n   * {@link https://docs.tor.us/torus-wallet/developing-with-torus-wallet/oauth | Documentation}\n   */\n  [verifier: string]: LoginConfigItem;\n}\n\nexport interface TorusNodePub {\n  /**\n   * X component of a Public Key\n   */\n  X: string;\n  /**\n   * Y component of a Public Key\n   */\n  Y: string;\n}\n\nexport interface TorusPublicKey extends TorusNodePub {\n  /**\n   * Ethereum Public Address\n   */\n  address: string;\n}\n\nexport interface PaymentParams {\n  /**\n   * Address to send the funds to\n   */\n  selectedAddress?: string;\n  /**\n   * Default fiat currency for the user to make the payment in\n   */\n  selectedCurrency?: string;\n  /**\n   * Amount to buy in the selectedCurrency\n   */\n  fiatValue?: number;\n  /**\n   * Cryptocurrency to buy\n   */\n  selectedCryptoCurrency?: string;\n  /**\n   * Chain Network to use\n   */\n  chainNetwork?: SUPPORTED_PAYMENT_NETWORK_TYPE;\n}\n\nexport interface VerifierArgs {\n  /**\n   * Verifier Enum\n   */\n  verifier: \"google\" | \"reddit\" | \"discord\";\n  /**\n   * email for google\n   *\n   * username for reddit\n   *\n   * id for discord\n   */\n  verifierId: string;\n  /**\n   * If true, returns {@link TorusPublicKey}, else returns string\n   */\n  isExtended?: boolean;\n}\n\nexport interface LoginParams {\n  verifier?: string;\n  login_hint?: string;\n}\n\nexport interface UserInfo {\n  /**\n   * Email of the logged in user\n   */\n  email: string;\n  /**\n   * Full name of the logged in user\n   */\n  name: string;\n  /**\n   * Profile image of the logged in user\n   */\n  profileImage: string;\n  /**\n   * verifier of the logged in user (google, facebook etc)\n   */\n  verifier: string;\n  /**\n   * Verifier Id of the logged in user\n   *\n   * email for google,\n   * id for facebook,\n   * username for reddit,\n   * id for twitch,\n   * id for discord\n   */\n  verifierId: string;\n  /**\n   * Returns if the logged in user is new\n   */\n  isNewUser: boolean;\n\n  /**\n   * login type of the logged in user (google, facebook etc)\n   */\n  typeOfLogin: LOGIN_TYPE;\n}\n\nexport interface LocaleLinks<T> {\n  /**\n   * Item corresponding to english\n   */\n  en?: T;\n  /**\n   * Item corresponding to japanese\n   */\n  ja?: T;\n  /**\n   * Item corresponding to korean\n   */\n  ko?: T;\n  /**\n   * Item corresponding to german\n   */\n  de?: T;\n  /**\n   * Item corresponding to chinese (simplified)\n   */\n  zh?: T;\n  /**\n   * Item corresponding to spanish\n   */\n  es?: T;\n}\n\nexport interface ThemeParams {\n  /**\n   * If true, enables dark mode\n   * Defaults to false\n   * @defaultValue false\n   */\n  isDark: boolean;\n  /**\n   * Colors object to customize colors in torus theme.\n   *\n   * Contact us for whitelabel. Example provided in `examples/vue-app`\n   */\n  colors: Record<string, string>;\n}\n\nexport interface IntegrityParams {\n  /**\n   * Whether to check for integrity.\n   * Defaults to false\n   * @defaultValue false\n   */\n  check: boolean;\n  /**\n   * if check is true, hash must be provided. The SRI sha-384 integrity hash\n   * {@link https://www.srihash.org/ | SRI Hash}\n   */\n  hash?: string;\n  /**\n   * Version of torus-website to load\n   */\n  version?: string;\n}\n\nexport interface VerifierStatus {\n  /**\n   * Defaults to true\n   * @defaultValue true\n   */\n  google?: boolean;\n  /**\n   * Defaults to true\n   * @defaultValue true\n   */\n  facebook?: boolean;\n  /**\n   * Defaults to true\n   * @defaultValue true\n   */\n  reddit?: boolean;\n  /**\n   * Defaults to true\n   * @defaultValue true\n   */\n  twitch?: boolean;\n  /**\n   * Defaults to true\n   * @defaultValue true\n   */\n  discord?: boolean;\n}\n\nexport interface WhiteLabelParams {\n  /**\n   * Whitelabel theme\n   */\n  theme: ThemeParams;\n  /**\n   * Language of whitelabel.\n   *\n   * order of preference: Whitelabel language \\> user language (in torus-website) \\> browser language\n   */\n  defaultLanguage?: string;\n  /**\n   * Logo Url to be used in light mode (dark logo)\n   */\n  logoDark: string;\n  /**\n   * Logo Url to be used in dark mode (light logo)\n   */\n  logoLight: string;\n  /**\n   * Shows/hides topup option in torus-website/widget.\n   * Defaults to false\n   * @defaultValue false\n   */\n  topupHide?: boolean;\n  /**\n   * Shows/hides billboard in torus-website.\n   * Defaults to false\n   * @defaultValue false\n   */\n  featuredBillboardHide?: boolean;\n  /**\n   * Shows/hides disclaimers on login page. Only works if special logins are hidden\n   * Defaults to false\n   * @defaultValue false\n   */\n  disclaimerHide?: boolean;\n  /**\n   * Language specific link for terms and conditions on torus-website. See (examples/vue-app) to configure\n   */\n  tncLink?: LocaleLinks<string>;\n  /**\n   * Language specific link for privacy policy on torus-website. See (examples/vue-app) to configure\n   */\n  privacyPolicy?: LocaleLinks<string>;\n  /**\n   * Language specific link for privacy policy on torus-website. See (examples/vue-app) to configure\n   */\n  contactLink?: LocaleLinks<string>;\n  /**\n   * Custom translations. See (examples/vue-app) to configure\n   */\n  customTranslations?: LocaleLinks<unknown>;\n}\n\nexport interface TorusParams {\n  /**\n   * Torus Network Object\n   */\n  network?: NetworkInterface;\n  /**\n   * Build Environment of Torus.\n   *\n   * production uses https://app.tor.us,\n   *\n   * development uses http://localhost:4050 (expects torus-website to be run locally),\n   *\n   * binance uses https://binance.tor.us,\n   *\n   * lrc uses https://lrc.tor.us,\n   *\n   * beta uses https://beta.tor.us, (currently supports tkey)\n   *\n   * testing uses https://testing.tor.us (latest internal build)\n   * @defaultValue production\n   */\n  buildEnv?: TORUS_BUILD_ENV_TYPE;\n  /**\n   * Enables or disables logging.\n   *\n   * Defaults to false in prod and true in other environments\n   */\n  enableLogging?: boolean;\n  /**\n   * whether to show/hide torus widget.\n   *\n   * Defaults to true\n   * @defaultValue true\n   */\n  showTorusButton?: boolean;\n  /**\n   * setting false, hides those verifiers from login modal\n   * @deprecated\n   * Please use loginConfig instead\n   */\n  enabledVerifiers?: VerifierStatus;\n  /**\n   * Array of login config items. Used to modify the default logins/ add new logins\n   */\n  loginConfig?: LoginConfig;\n  /**\n   * Params to enable integrity checks and load specific versions of torus-website\n   */\n  integrity?: IntegrityParams;\n  /**\n   * Params to enable whitelabelling of torus website and widget\n   */\n  whiteLabel?: WhiteLabelParams;\n  /**\n   * Skips TKey onboarding for new users\n   *\n   * Defaults to false\n   * @defaultValue false\n   */\n  skipTKey?: boolean;\n  /**\n   * Prefers to use localStorage instead of sessionStorage for torus iframe. Allows longer lived sessions\n   *\n   * Defaults to false\n   * @defaultValue false\n   */\n  useLocalStorage?: boolean;\n\n  /**\n   * Setting `useWalletConnect` to true allows to display wallet connect qr scanner from torus-embed.\n   *\n   * Defaults to false\n   * @defaultValue false\n   */\n  useWalletConnect?: boolean;\n}\n\nexport interface UnvalidatedJsonRpcRequest {\n  id?: JRPCId;\n  jsonrpc?: JRPCVersion;\n  method: string;\n  params?: unknown;\n  preopenInstanceId?: string;\n}\n\nexport interface ProviderOptions {\n  /**\n   * The name of the stream used to connect to the wallet.\n   */\n  jsonRpcStreamName?: string;\n\n  /**\n   * The maximum number of event listeners.\n   */\n  maxEventListeners?: number;\n  /**\n   * Whether the provider should send page metadata.\n   */\n  shouldSendMetadata?: boolean;\n}\n\nexport interface RequestArguments {\n  /** The RPC method to request. */\n  method: string;\n\n  /** The params of the RPC method, if any. */\n  params?: unknown[] | Record<string, unknown>;\n}\n\nexport interface BaseProviderState {\n  accounts: null | string[];\n  isConnected: boolean;\n  isUnlocked: boolean;\n  initialized: boolean;\n  isPermanentlyDisconnected: boolean;\n  hasEmittedConnection: boolean;\n}\n\nexport interface JsonRpcConnection {\n  events: SafeEventEmitter;\n  middleware: JRPCMiddleware<unknown, unknown>;\n  stream: Duplex;\n}\n\nexport interface SentWarningsState {\n  // methods\n  enable: boolean;\n  experimentalMethods: boolean;\n  send: boolean;\n  publicConfigStore: boolean;\n  // events\n  events: {\n    close: boolean;\n    data: boolean;\n    networkChanged: boolean;\n    notification: boolean;\n  };\n}\n\nexport interface SendSyncJsonRpcRequest extends JRPCRequest<unknown> {\n  method: \"eth_accounts\" | \"eth_coinbase\" | \"eth_uninstallFilter\" | \"net_version\";\n}\n\nexport interface PublicConfigState {\n  isUnlocked?: boolean;\n  selectedAddress?: string;\n  chainId?: string;\n  networkVersion?: string;\n  storageKey: string;\n}\n\nexport type Maybe<T> = Partial<T> | null | undefined;\n\nexport type BufferEncoding = \"ascii\" | \"utf8\" | \"utf-8\" | \"utf16le\" | \"ucs2\" | \"ucs-2\" | \"base64\" | \"base64url\" | \"latin1\" | \"binary\" | \"hex\";\n\nexport type IObjectMultiplex = Duplex;\n\nexport type WalletProviderState = {\n  accounts: string[];\n  chainId: string;\n  isUnlocked: boolean;\n  networkVersion: string;\n};\n","import { PAYMENT_PROVIDER } from \"./interfaces\";\n/**\n * From https://min-api.cryptocompare.com/data/v2/pair/mapping/fsym?fsym=BTC&extraParams=YourSite\n * GET https://min-api.cryptocompare.com/data/v2/pair/mapping/fsym?fsym=BTC\n * Then map over returned entries, picking tsym\n *\n * Last updated: Date of commit\n */\nexport const CRYPTO_COMPARE_CURRENCIES = [\n  \"ETH\",\n  \"USDT\",\n  \"USDC\",\n  \"TUSD\",\n  \"EOSDT\",\n  \"USD\",\n  \"DAI\",\n  \"GUSD\",\n  \"DKKT\",\n  \"PAX\",\n  \"ILS\",\n  \"RUB\",\n  \"BYN\",\n  \"EUR\",\n  \"GBP\",\n  \"JPY\",\n  \"KRW\",\n  \"PLN\",\n  \"MXN\",\n  \"AUD\",\n  \"BRL\",\n  \"CAD\",\n  \"CHF\",\n  \"KPW\",\n  \"LAK\",\n  \"LBP\",\n  \"LKR\",\n  \"XOF\",\n  \"CNHT\",\n  \"DOGE\",\n  \"UAH\",\n  \"TRY\",\n  \"HKD\",\n  \"XJP\",\n  \"SGD\",\n  \"USC\",\n  \"NZD\",\n  \"NGN\",\n  \"RUR\",\n  \"COP\",\n  \"GHS\",\n  \"EGP\",\n  \"IDR\",\n  \"BHD\",\n  \"CRC\",\n  \"PEN\",\n  \"AED\",\n  \"DOP\",\n  \"PKR\",\n  \"HUF\",\n  \"VND\",\n  \"XAR\",\n  \"LTC\",\n  \"RON\",\n  \"OMR\",\n  \"MYR\",\n  \"DKK\",\n  \"UGX\",\n  \"ZMW\",\n  \"SAR\",\n  \"SEK\",\n  \"GEL\",\n  \"RWF\",\n  \"IRR\",\n  \"TZS\",\n  \"CNY\",\n  \"VEF\",\n  \"BDT\",\n  \"HRK\",\n  \"CLP\",\n  \"THB\",\n  \"XAF\",\n  \"ARS\",\n  \"UYU\",\n  \"SZL\",\n  \"KZT\",\n  \"NOK\",\n  \"KES\",\n  \"PAB\",\n  \"INR\",\n  \"CZK\",\n  \"MAD\",\n  \"TWD\",\n  \"PHP\",\n  \"ZAR\",\n  \"BOB\",\n  \"CDF\",\n  \"DASH\",\n  \"VES\",\n  \"ISK\",\n  \"MWK\",\n  \"BAM\",\n  \"TTD\",\n  \"XRP\",\n  \"JOD\",\n  \"RSD\",\n  \"HNL\",\n  \"BGN\",\n  \"GTQ\",\n  \"BWP\",\n  \"XMR\",\n  \"MMK\",\n  \"QAR\",\n  \"AOA\",\n  \"KWD\",\n  \"MUR\",\n  \"WUSD\",\n  \"WEUR\",\n  \"WAVES\",\n  \"WTRY\",\n  \"LRD\",\n  \"LSL\",\n  \"LYD\",\n  \"AWG\",\n  \"MDL\",\n  \"BTO\",\n  \"EURS\",\n  \"CHFT\",\n  \"MKD\",\n  \"MNT\",\n  \"MOP\",\n  \"MRO\",\n  \"MVR\",\n  \"VOLLAR\",\n  \"CKUSD\",\n  \"KHR\",\n  \"VUV\",\n  \"BITCNY\",\n  \"QC\",\n  \"BBD\",\n  \"NAD\",\n  \"NPR\",\n  \"PGK\",\n  \"PYG\",\n  \"BIF\",\n  \"BMD\",\n  \"BND\",\n  \"XLM\",\n  \"BNB\",\n  \"SCR\",\n  \"BAT\",\n  \"CRO\",\n  \"HT\",\n  \"KCS\",\n  \"LEO\",\n  \"LINK\",\n  \"MKR\",\n  \"NPXS\",\n  \"OMG\",\n  \"REP\",\n  \"ZB\",\n  \"ZIL\",\n  \"ZRX\",\n  \"BCH\",\n  \"BZD\",\n  \"CUP\",\n  \"CVE\",\n  \"DJF\",\n  \"DZD\",\n  \"ERN\",\n  \"ETB\",\n  \"FJD\",\n  \"FKP\",\n  \"BUSD\",\n  \"ANCT\",\n  \"ALL\",\n  \"AMD\",\n  \"ANG\",\n  \"CNYX\",\n  \"IQD\",\n  \"UZS\",\n  \"TND\",\n  \"GGP\",\n  \"XAU\",\n  \"KGS\",\n  \"GIP\",\n  \"JMD\",\n  \"ZEC\",\n  \"USDP\",\n  \"BSV\",\n  \"EMC2\",\n  \"SNT\",\n  \"GTO\",\n  \"POWR\",\n  \"EUSD\",\n  \"EURT\",\n  \"BCY\",\n  \"BTS\",\n  \"ATM\",\n  \"BLOCKPAY\",\n  \"ARDR\",\n  \"AMP\",\n  \"B2X\",\n  \"BITGOLD\",\n  \"BITEUR\",\n  \"ATB\",\n  \"BITUSD\",\n  \"AGRS\",\n  \"DFXT\",\n  \"HIKEN\",\n  \"BIX\",\n  \"KNC\",\n  \"EOS\",\n  \"COB\",\n  \"COSS\",\n  \"BMH\",\n  \"NANO\",\n  \"BDG\",\n  \"BNT\",\n  \"XVG\",\n  \"LKK1Y\",\n  \"LKK\",\n  \"USDK\",\n  \"EURN\",\n  \"NZDT\",\n  \"JSE\",\n  \"GMD\",\n  \"GNF\",\n  \"GYD\",\n  \"YER\",\n  \"XPF\",\n  \"HTG\",\n  \"SLL\",\n  \"SOS\",\n  \"WST\",\n  \"SVC\",\n  \"SYP\",\n  \"NEO\",\n  \"KMF\",\n  \"JUMP\",\n  \"AYA\",\n  \"BLAST\",\n  \"WGR\",\n  \"BCN\",\n  \"BTG\",\n  \"URALS\",\n  \"INN\",\n  \"USDQ\",\n  \"CNH\",\n  \"HUSD\",\n  \"BKRW\",\n  \"NZDX\",\n  \"EURX\",\n  \"CADX\",\n  \"USDEX\",\n  \"JPYX\",\n  \"AUDX\",\n  \"VNDC\",\n  \"EON\",\n  \"GBPX\",\n  \"CHFX\",\n  \"USDJ\",\n  \"IDRT\",\n  \"USDS\",\n  \"USDN\",\n  \"BIDR\",\n  \"IDK\",\n  \"BSD\",\n  \"BTN\",\n  \"KYD\",\n  \"NIO\",\n  \"SBD\",\n  \"SDG\",\n  \"SHP\",\n  \"TOP\",\n  \"XCD\",\n  \"XCHF\",\n  \"CNYT\",\n  \"GYEN\",\n  \"ZUSD\",\n  \"GOLD\",\n  \"TRX\",\n  \"TRYB\",\n  \"PLATC\",\n  \"STRAX\",\n  \"UST\",\n  \"GLM\",\n  \"VAI\",\n  \"BRZ\",\n  \"DDRST\",\n  \"XAUT\",\n  \"MIM\",\n];\n\n/**\n * currencies supported by the payment provider\n * Last updated: Date of commit\n */\nconst PROVIDER_SUPPORTED_FIAT_CURRENCIES = {\n  // https://integrations.simplex.com/supported_currencies\n  // https://support.moonpay.com/hc/en-gb/articles/360011931457-Which-fiat-currencies-are-supported-\n  [PAYMENT_PROVIDER.MOONPAY]: [\n    \"AUD\",\n    \"BGN\",\n    \"BRL\",\n    \"CAD\",\n    \"CHF\",\n    \"CNY\",\n    \"COP\",\n    \"CZK\",\n    \"DKK\",\n    \"DOP\",\n    \"EGP\",\n    \"EUR\",\n    \"GBP\",\n    \"HKD\",\n    \"HRK\",\n    \"IDR\",\n    \"ILS\",\n    \"JPY\",\n    \"JOD\",\n    \"KES\",\n    \"KRW\",\n    \"KWD\",\n    \"LKR\",\n    \"MAD\",\n    \"MXN\",\n    \"MYR\",\n    \"NGN\",\n    \"NOK\",\n    \"NZD\",\n    \"OMR\",\n    \"PEN\",\n    \"PKR\",\n    \"PLN\",\n    \"RON\",\n    \"RUB\",\n    \"SEK\",\n    \"SGD\",\n    \"THB\",\n    \"TRY\",\n    \"TWD\",\n    \"USD\",\n    \"VND\",\n    \"ZAR\",\n  ],\n  /**\n   * https://docs.sendwyre.com/docs/supported-currencies#fiat\n   * The ones where credit card is supported\n   */\n  [PAYMENT_PROVIDER.WYRE]: [\n    \"USD\",\n    \"EUR\",\n    \"GBP\",\n    \"AUD\",\n    \"CAD\",\n    \"NZD\",\n    \"ARS\",\n    \"BRL\",\n    \"CHF\",\n    \"CLP\",\n    \"COP\",\n    \"CZK\",\n    \"DKK\",\n    \"HKD\",\n    \"ILS\",\n    \"INR\",\n    \"ISK\",\n    \"JPY\",\n    \"KRW\",\n    \"MXN\",\n    \"MYR\",\n    \"NOK\",\n    \"PHP\",\n    \"PLN\",\n    \"SEK\",\n    \"THB\",\n    \"VND\",\n    \"ZAR\",\n  ],\n  // https://support.ramp.network/en/articles/471-why-am-i-paying-in-usd-eur-gbp\n  [PAYMENT_PROVIDER.RAMPNETWORK]: [\"USD\", \"EUR\", \"GBP\"],\n  // From https://xanpool.com/ fiat select dropdown\n  [PAYMENT_PROVIDER.XANPOOL]: [\"SGD\", \"HKD\", \"THB\", \"PHP\", \"INR\", \"IDR\", \"MYR\", \"AUD\", \"NZD\", \"KRW\"],\n  // https://support.aax.com/en/articles/5295762-mercuryo\n  // RUB / UAH currently not supported\n  [PAYMENT_PROVIDER.MERCURYO]: [\"EUR\", \"USD\", \"GBP\", \"TRY\", \"JPY\", \"BRL\", \"NGN\", \"VND\", \"MXN\", \"KRW\"],\n  /**\n   * https://support.transak.com/hc/en-us/articles/360020615578-Credit-and-Debit-Card-Payments-through-Transak\n   * or\n   * https://transak.stoplight.io/docs/transak-docs/b3A6OTk1ODQ0-2-get-fiat-currencies\n   */\n  [PAYMENT_PROVIDER.TRANSAK]: [\n    \"ARS\",\n    \"AUD\",\n    \"BBD\",\n    \"BGN\",\n    \"BMD\",\n    \"BRL\",\n    \"CAD\",\n    \"CHF\",\n    \"CLP\",\n    \"CRC\",\n    \"CZK\",\n    \"DKK\",\n    \"DOP\",\n    \"EUR\",\n    \"FJD\",\n    \"FKP\",\n    \"GBP\",\n    \"GIP\",\n    \"HRK\",\n    \"HUF\",\n    \"IDR\",\n    \"ILS\",\n    \"ISK\",\n    \"JMD\",\n    \"JPY\",\n    \"KES\",\n    \"KRW\",\n    \"MDL\",\n    \"MXN\",\n    \"MYR\",\n    \"NOK\",\n    \"NZD\",\n    \"PEN\",\n    \"PHP\",\n    \"PLN\",\n    \"PYG\",\n    \"RON\",\n    \"SEK\",\n    \"SGD\",\n    \"THB\",\n    \"TRY\",\n    \"TZS\",\n    \"USD\",\n    \"ZAR\",\n  ],\n};\n\nconst cryptoCompareCurrenciesSet = new Set(CRYPTO_COMPARE_CURRENCIES);\n/**\n * Fiat currencies that we support\n */\nexport function supportedFiatCurrencies(provider) {\n  const providerSupportedFiatCurrencies = PROVIDER_SUPPORTED_FIAT_CURRENCIES[provider];\n  return providerSupportedFiatCurrencies.filter((currency) => cryptoCompareCurrenciesSet.has(currency));\n}\n","import { EMBED_TRANSLATION_ITEM, IPaymentProvider, LocaleLinks, PAYMENT_PROVIDER, SUPPORTED_PAYMENT_NETWORK, WALLET_VERIFIERS } from \"./interfaces\";\nimport { supportedFiatCurrencies } from \"./supportedCurrencies\";\n\nconst paymentProviders = {\n  [PAYMENT_PROVIDER.MOONPAY]: {\n    line1: \"Credit/ Debit Card/ Apple Pay\",\n    line2: \"4.5% or 5 USD\",\n    line3: \"2,000/day, 10,000/mo\",\n    supportPage: \"https://help.moonpay.io/en/\",\n    minOrderValue: 24.99,\n    maxOrderValue: 50_000,\n    validCurrencies: supportedFiatCurrencies(PAYMENT_PROVIDER.MOONPAY),\n    validCryptoCurrenciesByChain: {\n      [SUPPORTED_PAYMENT_NETWORK.MAINNET]: [\n        { value: \"aave\", display: \"AAVE\" },\n        { value: \"bat\", display: \"BAT\" },\n        { value: \"dai\", display: \"DAI\" },\n        { value: \"eth\", display: \"ETH\" },\n        { value: \"mkr\", display: \"MKR\" },\n        { value: \"matic\", display: \"MATIC\" },\n        { value: \"usdt\", display: \"USDT\" },\n        { value: \"usdc\", display: \"USDC\" },\n      ],\n      [SUPPORTED_PAYMENT_NETWORK.MATIC]: [\n        { value: \"eth_polygon\", display: \"ETH\" },\n        { value: \"matic_polygon\", display: \"MATIC\" },\n        { value: \"usdc_polygon\", display: \"USDC\" },\n      ],\n      [SUPPORTED_PAYMENT_NETWORK.BSC_MAINNET]: [\n        { value: \"bnb_bsc\", display: \"BNB\" },\n        { value: \"busd_bsc\", display: \"BUSD\" },\n      ],\n      [SUPPORTED_PAYMENT_NETWORK.AVALANCHE_MAINNET]: [{ value: \"avax_cchain\", display: \"AVAX\" }],\n    },\n    includeFees: true,\n    api: true,\n    enforceMax: false,\n  } as IPaymentProvider,\n  [PAYMENT_PROVIDER.WYRE]: {\n    line1: \"Apple Pay/ Debit/ Credit Card\",\n    line2: \"4.9% + 30 or 5 USD\",\n    line3: \"$250/day\",\n    supportPage: \"https://support.sendwyre.com/en/\",\n    minOrderValue: 5,\n    maxOrderValue: 500,\n    validCurrencies: supportedFiatCurrencies(PAYMENT_PROVIDER.WYRE),\n    validCryptoCurrenciesByChain: {\n      [SUPPORTED_PAYMENT_NETWORK.MAINNET]: [\n        { value: \"AAVE\", display: \"AAVE\" },\n        { value: \"BAT\", display: \"BAT\" },\n        { value: \"BUSD\", display: \"BUSD\" },\n        { value: \"DAI\", display: \"DAI\" },\n        { value: \"ETH\", display: \"ETH\" },\n        { value: \"MKR\", display: \"MKR\" },\n        { value: \"UNI\", display: \"UNI\" },\n        { value: \"USDC\", display: \"USDC\" },\n        { value: \"USDT\", display: \"USDT\" },\n      ],\n      [SUPPORTED_PAYMENT_NETWORK.MATIC]: [{ value: \"MUSDC\", display: \"USDC\" }],\n      // AVAXC? or AVAX?\n      [SUPPORTED_PAYMENT_NETWORK.AVALANCHE_MAINNET]: [{ value: \"AVAXC\", display: \"AVAXC\" }],\n    },\n    includeFees: false,\n    api: true,\n    enforceMax: false,\n  } as IPaymentProvider,\n  [PAYMENT_PROVIDER.RAMPNETWORK]: {\n    line1: \"Debit Card/ <br>Apple Pay/ Bank transfer\",\n    line2: \"0.49% - 2.9%\",\n    line3: \"5,000/purchase, 20,000/mo\",\n    supportPage: \"https://instant.ramp.network/\",\n    minOrderValue: 50,\n    maxOrderValue: 20_000,\n    validCurrencies: supportedFiatCurrencies(PAYMENT_PROVIDER.RAMPNETWORK),\n    validCryptoCurrenciesByChain: {\n      [SUPPORTED_PAYMENT_NETWORK.MAINNET]: [\n        { value: \"ETH\", display: \"ETH\" },\n        { value: \"DAI\", display: \"DAI\" },\n        { value: \"USDC\", display: \"USDC\" },\n        { value: \"USDT\", display: \"USDT\" },\n      ],\n      [SUPPORTED_PAYMENT_NETWORK.MATIC]: [\n        { value: \"MATIC_DAI\", display: \"DAI\" },\n        { value: \"MATIC_MATIC\", display: \"MATIC\" },\n        { value: \"MATIC_USDC\", display: \"USDC\" },\n      ],\n      // what about AVAXC?\n      [SUPPORTED_PAYMENT_NETWORK.AVALANCHE_MAINNET]: [{ value: \"AVAX\", display: \"AVAX\" }],\n      // Temporary unavailable\n      // [SUPPORTED_PAYMENT_NETWORK.XDAI]: [{ value: 'XDAI_XDAI', display: 'XDAI' }],\n    },\n    includeFees: true,\n    api: true,\n    receiveHint: \"walletTopUp.receiveHintRamp\",\n    enforceMax: false,\n  } as IPaymentProvider,\n  [PAYMENT_PROVIDER.XANPOOL]: {\n    line1: \"PayNow/ InstaPay/ FPS/ GoJekPay/ UPI/ PromptPay/ <br>ViettelPay/ DuitNow\",\n    line2: \"2.5% buying, 3% selling\",\n    line3: \"$2,500 / day\",\n    supportPage: \"mailto:support@xanpool.com\",\n    minOrderValue: 100,\n    maxOrderValue: 2500,\n    validCurrencies: supportedFiatCurrencies(PAYMENT_PROVIDER.XANPOOL),\n    validCryptoCurrenciesByChain: {\n      [SUPPORTED_PAYMENT_NETWORK.MAINNET]: [\n        { value: \"ETH\", display: \"ETH\" },\n        { value: \"USDT\", display: \"USDT\" },\n      ],\n    },\n    includeFees: true,\n    api: true,\n    sell: true,\n    enforceMax: false,\n  } as IPaymentProvider,\n  [PAYMENT_PROVIDER.MERCURYO]: {\n    line1: \"Credit/ Debit Card/ Apple Pay\",\n    line2: \"3.95% or 4 USD\",\n    line3: \"10,000/day, 25,000/mo\",\n    supportPage: \"mailto:support@mercuryo.io\",\n    minOrderValue: 30,\n    maxOrderValue: 5000,\n    validCurrencies: supportedFiatCurrencies(PAYMENT_PROVIDER.MERCURYO),\n    validCryptoCurrenciesByChain: {\n      [SUPPORTED_PAYMENT_NETWORK.MAINNET]: [\n        { value: \"ETH\", display: \"ETH\" },\n        { value: \"BAT\", display: \"BAT\" },\n        { value: \"USDT\", display: \"USDT\" },\n        { value: \"DAI\", display: \"DAI\" },\n      ],\n      [SUPPORTED_PAYMENT_NETWORK.BSC_MAINNET]: [\n        { value: \"BNB\", display: \"BNB\" },\n        { value: \"BUSD\", display: \"BUSD\" },\n        { value: \"1INCH\", display: \"1INCH\" },\n      ],\n    },\n    includeFees: true,\n    api: true,\n    enforceMax: false,\n  } as IPaymentProvider,\n  [PAYMENT_PROVIDER.TRANSAK]: {\n    line1: \"Credit/ Debit Card/ <br/>Bank Transfer (sepa/gbp)\",\n    line2: \"0.99% - 5.5% or 5 USD\",\n    line3: \"500/day\",\n    supportPage: \"https://support.transak.com/hc/en-US\",\n    minOrderValue: 30,\n    maxOrderValue: 500,\n    validCurrencies: supportedFiatCurrencies(PAYMENT_PROVIDER.TRANSAK),\n    validCryptoCurrenciesByChain: {\n      [SUPPORTED_PAYMENT_NETWORK.MAINNET]: [\n        { value: \"AAVE\", display: \"AAVE\" },\n        { value: \"DAI\", display: \"DAI\" },\n        { value: \"ETH\", display: \"ETH\" },\n        { value: \"USDC\", display: \"USDC\" },\n        { value: \"USDT\", display: \"USDT\" },\n      ],\n      [SUPPORTED_PAYMENT_NETWORK.MATIC]: [\n        { value: \"AAVE\", display: \"AAVE\" },\n        { value: \"DAI\", display: \"DAI\" },\n        { value: \"MATIC\", display: \"MATIC\" },\n        { value: \"USDC\", display: \"USDC\" },\n        { value: \"USDT\", display: \"USDT\" },\n        { value: \"WETH\", display: \"WETH\" },\n      ],\n      [SUPPORTED_PAYMENT_NETWORK.BSC_MAINNET]: [\n        { value: \"BNB\", display: \"BNB\" },\n        { value: \"BUSD\", display: \"BUSD\" },\n      ],\n      [SUPPORTED_PAYMENT_NETWORK.AVALANCHE_MAINNET]: [{ value: \"AVAX\", display: \"AVAX\" }],\n    },\n    includeFees: true,\n    enforceMax: true,\n  } as IPaymentProvider,\n};\n\nconst translations = {\n  en: {\n    embed: {\n      continue: \"Continue\",\n      actionRequired: \"Authorization required\",\n      pendingAction: \"Click continue to proceed with your request in a popup\",\n      cookiesRequired: \"Cookies Required\",\n      enableCookies: \"Please enable cookies in your browser preferences to access Torus\",\n      clickHere: \"More Info\",\n    },\n  },\n  de: {\n    embed: {\n      continue: \"Fortsetzen\",\n      actionRequired: \"Autorisierung erforderlich\",\n      pendingAction: \"Klicken Sie in einem Popup auf Weiter, um mit Ihrer Anfrage fortzufahren\",\n      cookiesRequired: \"Cookies bentigt\",\n      enableCookies: \"Bitte aktivieren Sie Cookies in Ihren Browsereinstellungen, um auf Torus zuzugreifen\",\n      clickHere: \"Mehr Info\",\n    },\n  },\n  ja: {\n    embed: {\n      continue: \"\",\n      actionRequired: \"\",\n      pendingAction: \"\",\n      cookiesRequired: \"\",\n      enableCookies: \"TorusCookie\",\n      clickHere: \"\",\n    },\n  },\n  ko: {\n    embed: {\n      continue: \"\",\n      actionRequired: \" \",\n      pendingAction: \"    .\",\n      cookiesRequired: \" \",\n      enableCookies: \"     Torus .\",\n      clickHere: \"  \",\n    },\n  },\n  zh: {\n    embed: {\n      continue: \"\",\n      actionRequired: \"\",\n      pendingAction: \"\",\n      cookiesRequired: \"Cookie\",\n      enableCookies: \"cookieTorus\",\n      clickHere: \"\",\n    },\n  },\n} as LocaleLinks<{ embed: EMBED_TRANSLATION_ITEM }>;\n\nexport default {\n  supportedVerifierList: Object.values(WALLET_VERIFIERS),\n  paymentProviders,\n  api: \"https://api.tor.us\",\n  translations,\n  prodTorusUrl: \"\",\n  localStorageKeyPrefix: `torus-`,\n};\n","import { Stream } from \"pump\";\n\nexport const runOnLoad = (fn: () => void): Promise<unknown> =>\n  new Promise((resolve, reject) => {\n    if (window.document.body != null) {\n      Promise.resolve(fn()).then(resolve).catch(reject);\n    } else {\n      window.document.addEventListener(\"DOMContentLoaded\", () => {\n        Promise.resolve(fn()).then(resolve).catch(reject);\n      });\n    }\n  });\n\nexport const runOnComplete = (fn: () => void): void => {\n  const retry = window.setInterval(() => {\n    if (window.document.readyState === \"complete\") {\n      window.clearInterval(retry);\n      fn();\n    }\n  }, 300);\n};\n\nexport const htmlToElement = <T extends Element>(html: string): T => {\n  const template = window.document.createElement(\"template\");\n  const trimmedHtml = html.trim(); // Never return a text node of whitespace as the result\n  template.innerHTML = trimmedHtml;\n  return template.content.firstChild as T;\n};\n\nexport const handleEvent = (handle: EventTarget, eventName: string, handler: (...args: unknown[]) => void, ...handlerArgs: unknown[]): void => {\n  const handlerWrapper = () => {\n    handler(...handlerArgs);\n    handle.removeEventListener(eventName, handlerWrapper);\n  };\n  handle.addEventListener(eventName, handlerWrapper);\n};\n\nexport const handleStream = (handle: Stream, eventName: string, handler: (chunk: unknown) => void): void => {\n  const handlerWrapper = (chunk: unknown) => {\n    handler(chunk);\n    handle.removeListener(eventName, handlerWrapper);\n  };\n  handle.on(eventName, handlerWrapper);\n};\n\nexport async function documentReady(): Promise<void> {\n  return new Promise<void>((resolve) => {\n    if (document.readyState !== \"loading\") {\n      resolve();\n    } else {\n      handleEvent(document, \"DOMContentLoaded\", resolve);\n    }\n  });\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@metamask/obs-store\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"eth-rpc-errors\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"fast-deep-equal\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"is-stream\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"pump\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"loglevel\");","import loglevel from \"loglevel\";\n\nexport default loglevel.getLogger(\"torus-embed\");\n","export default {\n  errors: {\n    disconnected: (): string => \"Torus: Lost connection to Torus.\",\n    permanentlyDisconnected: (): string => \"Torus: Disconnected from iframe. Page reload required.\",\n    sendSiteMetadata: (): string => \"Torus: Failed to send site metadata. This is an internal error, please report this bug.\",\n    unsupportedSync: (method: string): string =>\n      `Torus: The Torus Ethereum provider does not support synchronous methods like ${method} without a callback parameter.`,\n    invalidDuplexStream: (): string => \"Must provide a Node.js-style duplex stream.\",\n    invalidOptions: (maxEventListeners: number, shouldSendMetadata: boolean): string =>\n      `Invalid options. Received: { maxEventListeners: ${maxEventListeners}, shouldSendMetadata: ${shouldSendMetadata} }`,\n    invalidRequestArgs: (): string => `Expected a single, non-array, object argument.`,\n    invalidRequestMethod: (): string => `'args.method' must be a non-empty string.`,\n    invalidRequestParams: (): string => `'args.params' must be an object or array if provided.`,\n    invalidLoggerObject: (): string => `'args.logger' must be an object if provided.`,\n    invalidLoggerMethod: (method: string): string => `'args.logger' must include required method '${method}'.`,\n  },\n  info: {\n    connected: (chainId: string): string => `Torus: Connected to chain with ID \"${chainId}\".`,\n  },\n  warnings: {\n    // deprecated methods\n    enableDeprecation:\n      'Torus: \"\"ethereum.enable()\" is deprecated and may be removed in the future. ' +\n      'Please use \"ethereum.send(\"eth_requestAccounts\")\" instead. For more information, see: https://eips.ethereum.org/EIPS/eip-1102',\n    sendDeprecation:\n      'Torus: \"ethereum.send(...)\" is deprecated and may be removed in the future.' +\n      ' Please use \"ethereum.sendAsync(...)\" or \"ethereum.request(...)\" instead.\\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193',\n    events: {\n      close:\n        'Torus: The event \"close\" is deprecated and may be removed in the future. Please use \"disconnect\" instead.' +\n        \"\\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193\",\n      data:\n        'Torus: The event \"data\" is deprecated and will be removed in the future.' +\n        'Use \"message\" instead.\\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193#message',\n      networkChanged:\n        'Torus: The event \"networkChanged\" is deprecated and may be removed in the future.' +\n        ' Please use \"chainChanged\" instead.\\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193',\n      notification:\n        'Torus: The event \"notification\" is deprecated and may be removed in the future. ' +\n        'Please use \"message\" instead.\\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193',\n    },\n    publicConfigStore: 'Torus: The property \"publicConfigStore\" is deprecated and WILL be removed in the future.',\n  },\n};\n","import { get } from \"@toruslabs/http-helpers\";\nimport { JRPCMiddleware, PendingJRPCResponse, SafeEventEmitter } from \"@toruslabs/openlogin-jrpc\";\nimport { ethErrors } from \"eth-rpc-errors\";\nimport { LogLevelDesc } from \"loglevel\";\n\nimport config from \"./config\";\nimport { IntegrityParams, PAYMENT_PROVIDER, PAYMENT_PROVIDER_TYPE, PaymentParams } from \"./interfaces\";\nimport log from \"./loglevel\";\n\nconst { paymentProviders } = config;\n\ntype PaymentErrorParams = {\n  fiatValue?: string;\n  selectedCurrency?: string;\n  selectedCryptoCurrency?: string;\n};\n\ntype PaymentErrors = { provider?: string } & PaymentErrorParams;\n\nexport const validatePaymentProvider = (provider: string, params: PaymentParams): { errors: PaymentErrors; isValid: boolean } => {\n  const errors: PaymentErrors = {};\n\n  if (!provider) {\n    return { errors, isValid: true };\n  }\n\n  if (provider && !paymentProviders[provider]) {\n    errors.provider = \"Invalid Provider\";\n    return { errors, isValid: Object.keys(errors).length === 0 };\n  }\n\n  const selectedProvider = paymentProviders[provider as PAYMENT_PROVIDER_TYPE];\n  const selectedParams = params || {};\n\n  // set default values\n  // if (!selectedParams.selectedCurrency) [selectedParams.selectedCurrency] = selectedProvider.validCurrencies\n  // if (!selectedParams.fiatValue) selectedParams.fiatValue = selectedProvider.minOrderValue\n  // if (!selectedParams.selectedCryptoCurrency) [selectedParams.selectedCryptoCurrency] = selectedProvider.validCryptoCurrencies\n\n  // validations\n  if (selectedParams.fiatValue) {\n    const requestedOrderAmount = +parseFloat(selectedParams.fiatValue.toString()) || 0;\n    if (requestedOrderAmount < selectedProvider.minOrderValue) errors.fiatValue = \"Requested amount is lower than supported\";\n    if (requestedOrderAmount > selectedProvider.maxOrderValue && selectedProvider.enforceMax)\n      errors.fiatValue = \"Requested amount is higher than supported\";\n  }\n  if (selectedParams.selectedCurrency && !selectedProvider.validCurrencies.includes(selectedParams.selectedCurrency)) {\n    errors.selectedCurrency = \"Unsupported currency\";\n  }\n  if (selectedParams.selectedCryptoCurrency) {\n    const validCryptoCurrenciesByChain = Object.values(selectedProvider.validCryptoCurrenciesByChain)\n      .flat()\n      .map((currency) => currency.value);\n\n    const finalCryptoCurrency =\n      provider === PAYMENT_PROVIDER.MOONPAY ? selectedParams.selectedCryptoCurrency.toLowerCase() : selectedParams.selectedCryptoCurrency;\n\n    if (validCryptoCurrenciesByChain && !validCryptoCurrenciesByChain.includes(finalCryptoCurrency))\n      errors.selectedCryptoCurrency = \"Unsupported cryptoCurrency\";\n  }\n  return { errors, isValid: Object.keys(errors).length === 0 };\n};\n\n// utility functions\n\n/**\n * json-rpc-engine middleware that logs RPC errors and and validates req.method.\n *\n * @param log - The logging API to use.\n * @returns  json-rpc-engine middleware function\n */\nexport function createErrorMiddleware(): JRPCMiddleware<unknown, unknown> {\n  return (req, res, next) => {\n    // json-rpc-engine will terminate the request when it notices this error\n    if (typeof req.method !== \"string\" || !req.method) {\n      res.error = ethErrors.rpc.invalidRequest({\n        message: `The request 'method' must be a non-empty string.`,\n        data: req,\n      });\n    }\n\n    next((done) => {\n      const { error } = res;\n      if (!error) {\n        return done();\n      }\n      log.error(`MetaMask - RPC Error: ${error.message}`, error);\n      return done();\n    });\n  };\n}\n\n// resolve response.result or response, reject errors\nexport const getRpcPromiseCallback =\n  (resolve: (value?: any) => void, reject: (error?: Error) => void, unwrapResult = true) =>\n  (error: Error, response: PendingJRPCResponse<unknown>): void => {\n    if (error || response.error) {\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      reject(error || response.error);\n    } else {\n      resolve(!unwrapResult || Array.isArray(response) ? response : response.result);\n    }\n  };\n\n/**\n * Logs a stream disconnection error. Emits an 'error' if given an\n * EventEmitter that has listeners for the 'error' event.\n *\n * @param log - The logging API to use.\n * @param remoteLabel - The label of the disconnected stream.\n * @param error - The associated error to log.\n * @param emitter - The logging API to use.\n */\nexport function logStreamDisconnectWarning(remoteLabel: string, error: Error, emitter: SafeEventEmitter): void {\n  let warningMsg = `MetaMask: Lost connection to \"${remoteLabel}\".`;\n  if (error?.stack) {\n    warningMsg += `\\n${error.stack}`;\n  }\n  log.warn(warningMsg);\n  if (emitter && emitter.listenerCount(\"error\") > 0) {\n    emitter.emit(\"error\", warningMsg);\n  }\n}\n\nexport const getPreopenInstanceId = () => Math.random().toString(36).slice(2);\n\nexport const getTorusUrl = async (buildEnv: string, integrity: IntegrityParams): Promise<{ torusUrl: string; logLevel: LogLevelDesc }> => {\n  let torusUrl: string;\n  let logLevel: LogLevelDesc;\n  // Do not change this line\n  const version = process.env.TORUS_EMBED_VERSION;\n  let versionUsed = integrity.version || version;\n  try {\n    if ((buildEnv === \"binance\" || buildEnv === \"production\") && !integrity.version) {\n      let response: { data: string };\n      if (!config.prodTorusUrl)\n        response = await get(`${config.api}/latestversion?name=@toruslabs/torus-embed&version=${version}`, {}, { useAPIKey: true });\n      else response = { data: config.prodTorusUrl };\n      versionUsed = response.data;\n      // eslint-disable-next-line require-atomic-updates\n      config.prodTorusUrl = response.data;\n    }\n  } catch (error) {\n    log.error(error, \"unable to fetch latest version\");\n  }\n  log.info(\"version used: \", versionUsed);\n  switch (buildEnv) {\n    case \"binance\":\n      torusUrl = `https://binance.tor.us/v${versionUsed}`;\n      logLevel = \"info\";\n      break;\n    case \"testing\":\n      torusUrl = \"https://testing.tor.us\";\n      logLevel = \"debug\";\n      break;\n    case \"lrc\":\n      torusUrl = \"https://lrc.tor.us\";\n      logLevel = \"debug\";\n      break;\n    case \"beta\":\n      torusUrl = \"https://beta.tor.us\";\n      logLevel = \"debug\";\n      break;\n    case \"development\":\n      torusUrl = \"http://localhost:4050\";\n      logLevel = \"debug\";\n      break;\n    default:\n      torusUrl = `https://app.tor.us/v${versionUsed}`;\n      logLevel = \"error\";\n      break;\n  }\n  return { torusUrl, logLevel };\n};\n\nexport const getUserLanguage = (): string => {\n  let userLanguage = window.navigator.language || \"en-US\";\n  const userLanguages = userLanguage.split(\"-\");\n  userLanguage = Object.prototype.hasOwnProperty.call(config.translations, userLanguages[0]) ? userLanguages[0] : \"en\";\n  return userLanguage;\n};\n\nexport const EMITTED_NOTIFICATIONS = [\n  \"eth_subscription\", // per eth-json-rpc-filters/subscriptionManager\n];\n\nexport const NOOP = (): void => {\n  // empty function\n};\n\nexport const FEATURES_PROVIDER_CHANGE_WINDOW = \"directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=660,width=375\";\nexport const FEATURES_DEFAULT_WALLET_WINDOW = \"directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=740,width=1315\";\nexport const FEATURES_DEFAULT_POPUP_WINDOW = \"directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=700,width=1200\";\nexport const FEATURES_CONFIRM_WINDOW = \"directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=700,width=450\";\n\nexport function storageAvailable(type: \"localStorage\" | \"sessionStorage\"): boolean {\n  let storage: Storage;\n  try {\n    storage = window[type];\n    const x = \"__storage_test__\";\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return true;\n  } catch (e) {\n    return (\n      e &&\n      // everything except Firefox\n      (e.code === 22 ||\n        // Firefox\n        e.code === 1014 ||\n        // test name field too, because code might not be present\n        // everything except Firefox\n        e.name === \"QuotaExceededError\" ||\n        // Firefox\n        e.name === \"NS_ERROR_DOM_QUOTA_REACHED\") &&\n      // acknowledge QuotaExceededError only if there's something already stored\n      storage &&\n      storage.length !== 0\n    );\n  }\n}\n\nexport function getPopupFeatures(): string {\n  // Fixes dual-screen position                             Most browsers      Firefox\n  const dualScreenLeft = window.screenLeft !== undefined ? window.screenLeft : window.screenX;\n  const dualScreenTop = window.screenTop !== undefined ? window.screenTop : window.screenY;\n\n  const w = 1200;\n  const h = 700;\n\n  const width = window.innerWidth\n    ? window.innerWidth\n    : document.documentElement.clientWidth\n    ? document.documentElement.clientWidth\n    : window.screen.width;\n\n  const height = window.innerHeight\n    ? window.innerHeight\n    : document.documentElement.clientHeight\n    ? document.documentElement.clientHeight\n    : window.screen.height;\n\n  const systemZoom = 1; // No reliable estimate\n\n  const left = Math.abs((width - w) / 2 / systemZoom + dualScreenLeft);\n  const top = Math.abs((height - h) / 2 / systemZoom + dualScreenTop);\n  const features = `titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=${h / systemZoom},width=${w / systemZoom},top=${top},left=${left}`;\n  return features;\n}\n","import { ObservableStore, storeAsStream } from \"@metamask/obs-store\";\nimport {\n  createIdRemapMiddleware,\n  createStreamMiddleware,\n  JRPCEngine,\n  JRPCRequest,\n  JRPCResponse,\n  JRPCSuccess,\n  ObjectMultiplex,\n  SafeEventEmitter,\n} from \"@toruslabs/openlogin-jrpc\";\nimport { EthereumRpcError, ethErrors } from \"eth-rpc-errors\";\nimport dequal from \"fast-deep-equal\";\nimport { duplex as isDuplexStream } from \"is-stream\";\nimport pump from \"pump\";\nimport type { Duplex } from \"readable-stream\";\n\nimport {\n  BaseProviderState,\n  JsonRpcConnection,\n  Maybe,\n  ProviderOptions,\n  PublicConfigState,\n  RequestArguments,\n  SendSyncJsonRpcRequest,\n  SentWarningsState,\n  UnvalidatedJsonRpcRequest,\n  WalletProviderState,\n} from \"./interfaces\";\nimport log from \"./loglevel\";\nimport messages from \"./messages\";\nimport { createErrorMiddleware, EMITTED_NOTIFICATIONS, logStreamDisconnectWarning, NOOP } from \"./utils\";\n\nSafeEventEmitter.defaultMaxListeners = 100;\n\n// resolve response.result, reject errors\nconst getRpcPromiseCallback =\n  (resolve, reject, unwrapResult = true) =>\n  (error, response) => {\n    if (error || response.error) {\n      return reject(error || response.error);\n    }\n    return !unwrapResult || Array.isArray(response) ? resolve(response) : resolve(response.result);\n  };\n\nclass TorusInpageProvider extends SafeEventEmitter {\n  protected static _defaultState: BaseProviderState = {\n    accounts: null,\n    isConnected: false,\n    isUnlocked: false,\n    initialized: false,\n    isPermanentlyDisconnected: false,\n    hasEmittedConnection: false,\n  };\n\n  /**\n   * The chain ID of the currently connected Ethereum chain.\n   * See [chainId.network]{@link https://chainid.network} for more information.\n   */\n  public chainId: string | null;\n\n  /**\n   * The user's currently selected Ethereum address.\n   * If null, MetaMask is either locked or the user has not permitted any\n   * addresses to be viewed.\n   */\n  public selectedAddress: string | null;\n\n  _rpcEngine: JRPCEngine;\n\n  public networkVersion: string | null;\n\n  shouldSendMetadata: boolean;\n\n  /**\n   * Indicating that this provider is a MetaMask provider.\n   */\n  public readonly isTorus: true;\n\n  _publicConfigStore: ObservableStore<PublicConfigState>;\n\n  tryPreopenHandle: (payload: UnvalidatedJsonRpcRequest | UnvalidatedJsonRpcRequest[], cb: (...args: unknown[]) => void) => void;\n\n  enable: () => Promise<string[]>;\n\n  protected _state: BaseProviderState;\n\n  protected _jsonRpcConnection: JsonRpcConnection;\n\n  protected _sentWarnings: SentWarningsState = {\n    // methods\n    enable: false,\n    experimentalMethods: false,\n    send: false,\n    publicConfigStore: false,\n    // events\n    events: {\n      close: false,\n      data: false,\n      networkChanged: false,\n      notification: false,\n    },\n  };\n\n  constructor(\n    connectionStream: Duplex,\n    { maxEventListeners = 100, shouldSendMetadata = true, jsonRpcStreamName = \"provider\" }: ProviderOptions = {}\n  ) {\n    super();\n    if (!isDuplexStream(connectionStream)) {\n      throw new Error(messages.errors.invalidDuplexStream());\n    }\n    this.isTorus = true;\n    this.setMaxListeners(maxEventListeners);\n\n    // private state\n    this._state = {\n      ...TorusInpageProvider._defaultState,\n    };\n\n    // public state\n    this.selectedAddress = null;\n    this.networkVersion = null;\n    this.chainId = null;\n    this.shouldSendMetadata = shouldSendMetadata;\n\n    // bind functions (to prevent e.g. web3@1.x from making unbound calls)\n    this._handleAccountsChanged = this._handleAccountsChanged.bind(this);\n    this._handleChainChanged = this._handleChainChanged.bind(this);\n    this._handleUnlockStateChanged = this._handleUnlockStateChanged.bind(this);\n    this._handleConnect = this._handleConnect.bind(this);\n    this._handleDisconnect = this._handleDisconnect.bind(this);\n    this._handleStreamDisconnect = this._handleStreamDisconnect.bind(this);\n    this._sendSync = this._sendSync.bind(this);\n    this._rpcRequest = this._rpcRequest.bind(this);\n    this._warnOfDeprecation = this._warnOfDeprecation.bind(this);\n    this._initializeState = this._initializeState.bind(this);\n\n    this.request = this.request.bind(this);\n    this.send = this.send.bind(this);\n    this.sendAsync = this.sendAsync.bind(this);\n    // this.enable = this.enable.bind(this);\n\n    // setup connectionStream multiplexing\n    const mux = new ObjectMultiplex();\n    pump(connectionStream, mux, connectionStream, this._handleStreamDisconnect.bind(this, \"MetaMask\"));\n\n    // subscribe to metamask public config (one-way)\n    this._publicConfigStore = new ObservableStore({ storageKey: \"Metamask-Config\" });\n\n    // handle isUnlocked changes, and chainChanged and networkChanged events\n    // this._publicConfigStore.subscribe((stringifiedState) => {\n    //   // This is because we are using store as string\n    //   const state = JSON.parse(stringifiedState as unknown as string);\n    //   if (\"isUnlocked\" in state && state.isUnlocked !== this._state.isUnlocked) {\n    //     this._state.isUnlocked = state.isUnlocked;\n    //     if (!this._state.isUnlocked) {\n    //       // accounts are never exposed when the extension is locked\n    //       this._handleAccountsChanged([]);\n    //     } else {\n    //       // this will get the exposed accounts, if any\n    //       try {\n    //         this._rpcRequest(\n    //           { method: \"eth_accounts\", params: [] },\n    //           NOOP,\n    //           true // indicating that eth_accounts _should_ update accounts\n    //         );\n    //       } catch (_) {\n    //         // Swallow error\n    //       }\n    //     }\n    //   }\n\n    //   if (\"selectedAddress\" in state && this.selectedAddress !== state.selectedAddress) {\n    //     try {\n    //       this._rpcRequest(\n    //         { method: \"eth_accounts\", params: [] },\n    //         NOOP,\n    //         true // indicating that eth_accounts _should_ update accounts\n    //       );\n    //     } catch (_) {\n    //       // Swallow error\n    //     }\n    //   }\n\n    //   // Emit chainChanged event on chain change\n    //   if (\"chainId\" in state && state.chainId !== this.chainId) {\n    //     this.chainId = state.chainId || null;\n    //     this.emit(\"chainChanged\", this.chainId);\n\n    //     // indicate that we've connected, for EIP-1193 compliance\n    //     // we do this here so that iframe can initialize\n    //     if (!this._state.hasEmittedConnection) {\n    //       this._handleConnect(this.chainId);\n    //       this._state.hasEmittedConnection = true;\n    //     }\n    //   }\n\n    //   // Emit networkChanged event on network change\n    //   if (\"networkVersion\" in state && state.networkVersion !== this.networkVersion) {\n    //     this.networkVersion = state.networkVersion || null;\n    //     this.emit(\"networkChanged\", this.networkVersion);\n    //   }\n    // });\n\n    pump(\n      mux.createStream(\"publicConfig\") as unknown as Duplex,\n      storeAsStream(this._publicConfigStore),\n      // RPC requests should still work if only this stream fails\n      logStreamDisconnectWarning.bind(this, \"MetaMask PublicConfigStore\")\n    );\n    // ignore phishing warning message (handled elsewhere)\n    mux.ignoreStream(\"phishing\");\n\n    // setup own event listeners\n\n    // EIP-1193 connect\n    this.on(\"connect\", () => {\n      this._state.isConnected = true;\n    });\n\n    // connect to async provider\n\n    const jsonRpcConnection = createStreamMiddleware();\n    pump(\n      jsonRpcConnection.stream,\n      mux.createStream(jsonRpcStreamName) as unknown as Duplex,\n      jsonRpcConnection.stream,\n      this._handleStreamDisconnect.bind(this, \"MetaMask RpcProvider\")\n    );\n\n    // handle RPC requests via dapp-side rpc engine\n    const rpcEngine = new JRPCEngine();\n    rpcEngine.push(createIdRemapMiddleware());\n    rpcEngine.push(createErrorMiddleware());\n    rpcEngine.push(jsonRpcConnection.middleware);\n    this._rpcEngine = rpcEngine;\n\n    // json rpc notification listener\n    jsonRpcConnection.events.on(\"notification\", (payload) => {\n      const { method, params } = payload;\n      if (method === \"wallet_accountsChanged\") {\n        this._handleAccountsChanged(params);\n      } else if (method === \"wallet_unlockStateChanged\") {\n        this._handleUnlockStateChanged(params);\n      } else if (method === \"wallet_chainChanged\") {\n        this._handleChainChanged(params);\n      } else if (EMITTED_NOTIFICATIONS.includes(payload.method)) {\n        // EIP 1193 subscriptions, per eth-json-rpc-filters/subscriptionManager\n        this.emit(\"data\", payload); // deprecated\n        this.emit(\"notification\", params.result);\n        this.emit(\"message\", {\n          type: method,\n          data: params,\n        });\n      }\n\n      // Backward compatibility for older non EIP 1193 subscriptions\n      // this.emit('data', null, payload)\n    });\n  }\n\n  get publicConfigStore(): ObservableStore<PublicConfigState> {\n    if (!this._sentWarnings.publicConfigStore) {\n      log.warn(messages.warnings.publicConfigStore);\n      this._sentWarnings.publicConfigStore = true;\n    }\n    return this._publicConfigStore;\n  }\n\n  /**\n   * Returns whether the inpage provider is connected to Torus.\n   */\n  isConnected(): boolean {\n    return this._state.isConnected;\n  }\n\n  /**\n   * Submits an RPC request for the given method, with the given params.\n   * Resolves with the result of the method call, or rejects on error.\n   *\n   * @param args - The RPC request arguments.\n   * @returns A Promise that resolves with the result of the RPC method,\n   * or rejects if an error is encountered.\n   */\n  async request<T>(args: RequestArguments): Promise<Maybe<T>> {\n    if (!args || typeof args !== \"object\" || Array.isArray(args)) {\n      throw ethErrors.rpc.invalidRequest({\n        message: messages.errors.invalidRequestArgs(),\n        data: args,\n      });\n    }\n\n    const { method, params } = args;\n\n    if (typeof method !== \"string\" || method.length === 0) {\n      throw ethErrors.rpc.invalidRequest({\n        message: messages.errors.invalidRequestMethod(),\n        data: args,\n      });\n    }\n\n    if (params !== undefined && !Array.isArray(params) && (typeof params !== \"object\" || params === null)) {\n      throw ethErrors.rpc.invalidRequest({\n        message: messages.errors.invalidRequestParams(),\n        data: args,\n      });\n    }\n\n    return new Promise((resolve, reject) => {\n      this._rpcRequest({ method, params }, getRpcPromiseCallback(resolve, reject));\n    });\n  }\n\n  /**\n   * Submits an RPC request per the given JSON-RPC request object.\n   *\n   * @param payload - The RPC request object.\n   * @param cb - The callback function.\n   */\n  sendAsync(payload: JRPCRequest<unknown>, callback: (error: Error | null, result?: JRPCResponse<unknown>) => void): void {\n    this._rpcRequest(payload, callback);\n  }\n\n  /**\n   * We override the following event methods so that we can warn consumers\n   * about deprecated events:\n   *   addListener, on, once, prependListener, prependOnceListener\n   */\n\n  addListener(eventName: string, listener: (...args: unknown[]) => void): this {\n    this._warnOfDeprecation(eventName);\n    return super.addListener(eventName, listener);\n  }\n\n  on(eventName: string, listener: (...args: unknown[]) => void): this {\n    this._warnOfDeprecation(eventName);\n    return super.on(eventName, listener);\n  }\n\n  once(eventName: string, listener: (...args: unknown[]) => void): this {\n    this._warnOfDeprecation(eventName);\n    return super.once(eventName, listener);\n  }\n\n  prependListener(eventName: string, listener: (...args: unknown[]) => void): this {\n    this._warnOfDeprecation(eventName);\n    return super.prependListener(eventName, listener);\n  }\n\n  prependOnceListener(eventName: string, listener: (...args: unknown[]) => void): this {\n    this._warnOfDeprecation(eventName);\n    return super.prependOnceListener(eventName, listener);\n  }\n\n  // Private Methods\n  //= ===================\n  /**\n   * Constructor helper.\n   * Populates initial state by calling 'wallet_getProviderState' and emits\n   * necessary events.\n   */\n  async _initializeState(): Promise<void> {\n    try {\n      const { accounts, chainId, isUnlocked, networkVersion } = (await this.request({\n        method: \"wallet_getProviderState\",\n      })) as WalletProviderState;\n\n      // indicate that we've connected, for EIP-1193 compliance\n      this.emit(\"connect\", { chainId });\n\n      this._handleChainChanged({ chainId, networkVersion });\n      this._handleUnlockStateChanged({ accounts, isUnlocked });\n      this._handleAccountsChanged(accounts);\n    } catch (error) {\n      log.error(\"MetaMask: Failed to get initial state. Please report this bug.\", error);\n    } finally {\n      log.info(\"initialized state\");\n      this._state.initialized = true;\n      this.emit(\"_initialized\");\n    }\n  }\n\n  /**\n   * Internal RPC method. Forwards requests to background via the RPC engine.\n   * Also remap ids inbound and outbound.\n   *\n   * @param payload - The RPC request object.\n   * @param callback - The consumer's callback.\n   * @param isInternal - false - Whether the request is internal.\n   */\n  _rpcRequest(payload: UnvalidatedJsonRpcRequest | UnvalidatedJsonRpcRequest[], callback: (...args: any[]) => void, isInternal = false): void {\n    let cb = callback;\n    const _payload = payload;\n    if (!Array.isArray(_payload)) {\n      if (!_payload.jsonrpc) {\n        _payload.jsonrpc = \"2.0\";\n      }\n\n      if (_payload.method === \"eth_accounts\" || _payload.method === \"eth_requestAccounts\") {\n        // handle accounts changing\n        cb = (err: Error, res: JRPCSuccess<string[]>) => {\n          this._handleAccountsChanged(res.result || [], _payload.method === \"eth_accounts\", isInternal);\n          callback(err, res);\n        };\n      } else if (_payload.method === \"wallet_getProviderState\") {\n        this._rpcEngine.handle(payload as JRPCRequest<unknown>, cb);\n        return;\n      }\n    }\n    this.tryPreopenHandle(_payload, cb);\n  }\n\n  /**\n   * Submits an RPC request for the given method, with the given params.\n   *\n   * @deprecated Use \"request\" instead.\n   * @param method - The method to request.\n   * @param params - Any params for the method.\n   * @returns A Promise that resolves with the JSON-RPC response object for the\n   * request.\n   */\n  send<T>(method: string, params?: T[]): Promise<JRPCResponse<T>>;\n\n  /**\n   * Submits an RPC request per the given JSON-RPC request object.\n   *\n   * @deprecated Use \"request\" instead.\n   * @param payload - A JSON-RPC request object.\n   * @param callback - An error-first callback that will receive the JSON-RPC\n   * response object.\n   */\n  send<T>(payload: JRPCRequest<unknown>, callback: (error: Error | null, result?: JRPCResponse<T>) => void): void;\n\n  /**\n   * Accepts a JSON-RPC request object, and synchronously returns the cached result\n   * for the given method. Only supports 4 specific RPC methods.\n   *\n   * @deprecated Use \"request\" instead.\n   * @param payload - A JSON-RPC request object.\n   * @returns A JSON-RPC response object.\n   */\n  send<T>(payload: SendSyncJsonRpcRequest): JRPCResponse<T>;\n\n  send(methodOrPayload: unknown, callbackOrArgs?: unknown): unknown {\n    if (!this._sentWarnings.send) {\n      log.warn(messages.warnings.sendDeprecation);\n      this._sentWarnings.send = true;\n    }\n    if (typeof methodOrPayload === \"string\" && (!callbackOrArgs || Array.isArray(callbackOrArgs))) {\n      return new Promise((resolve, reject) => {\n        try {\n          this._rpcRequest({ method: methodOrPayload, params: callbackOrArgs }, getRpcPromiseCallback(resolve, reject, false));\n        } catch (error) {\n          reject(error);\n        }\n      });\n    }\n    if (methodOrPayload && typeof methodOrPayload === \"object\" && typeof callbackOrArgs === \"function\") {\n      return this._rpcRequest(methodOrPayload as JRPCRequest<unknown>, callbackOrArgs as (...args: unknown[]) => void);\n    }\n    return this._sendSync(methodOrPayload as SendSyncJsonRpcRequest);\n  }\n\n  /**\n   * DEPRECATED.\n   * Internal backwards compatibility method, used in send.\n   */\n  _sendSync(payload: SendSyncJsonRpcRequest): JRPCSuccess<unknown> {\n    let result;\n    switch (payload.method) {\n      case \"eth_accounts\":\n        result = this.selectedAddress ? [this.selectedAddress] : [];\n        break;\n\n      case \"eth_coinbase\":\n        result = this.selectedAddress || null;\n        break;\n\n      case \"eth_uninstallFilter\":\n        this._rpcRequest(payload, NOOP);\n        result = true;\n        break;\n\n      case \"net_version\":\n        result = this.networkVersion || null;\n        break;\n\n      default:\n        throw new Error(messages.errors.unsupportedSync(payload.method));\n    }\n\n    return {\n      id: payload.id,\n      jsonrpc: payload.jsonrpc,\n      result,\n    };\n  }\n\n  /**\n   * When the provider becomes connected, updates internal state and emits\n   * required events. Idempotent.\n   *\n   * @param chainId - The ID of the newly connected chain.\n   * emits MetaMaskInpageProvider#connect\n   */\n  protected _handleConnect(chainId: string): void {\n    if (!this._state.isConnected) {\n      this._state.isConnected = true;\n      this.emit(\"connect\", { chainId });\n      log.debug(messages.info.connected(chainId));\n    }\n  }\n\n  /**\n   * When the provider becomes disconnected, updates internal state and emits\n   * required events. Idempotent with respect to the isRecoverable parameter.\n   *\n   * Error codes per the CloseEvent status codes as required by EIP-1193:\n   * https://developer.mozilla.org/en-US/docs/Web/API/CloseEvent#Status_codes\n   *\n   * @param isRecoverable - Whether the disconnection is recoverable.\n   * @param errorMessage - A custom error message.\n   * emits MetaMaskInpageProvider#disconnect\n   */\n  protected _handleDisconnect(isRecoverable: boolean, errorMessage?: string): void {\n    if (this._state.isConnected || (!this._state.isPermanentlyDisconnected && !isRecoverable)) {\n      this._state.isConnected = false;\n\n      let error;\n      if (isRecoverable) {\n        error = new EthereumRpcError(\n          1013, // Try again later\n          errorMessage || messages.errors.disconnected()\n        );\n        log.debug(error);\n      } else {\n        error = new EthereumRpcError(\n          1011, // Internal error\n          errorMessage || messages.errors.permanentlyDisconnected()\n        );\n        log.error(error);\n        this.chainId = null;\n        this._state.accounts = null;\n        this.selectedAddress = null;\n        this._state.isUnlocked = false;\n        this._state.isPermanentlyDisconnected = true;\n      }\n\n      this.emit(\"disconnect\", error);\n    }\n  }\n\n  /**\n   * Called when connection is lost to critical streams.\n   *\n   * emits MetamaskInpageProvider#disconnect\n   */\n  protected _handleStreamDisconnect(streamName: string, error: Error): void {\n    logStreamDisconnectWarning(streamName, error, this);\n    this._handleDisconnect(false, error ? error.message : undefined);\n  }\n\n  /**\n   * Called when accounts may have changed.\n   */\n  protected _handleAccountsChanged(accounts: unknown[], isEthAccounts = false, isInternal = false): void {\n    // defensive programming\n    let finalAccounts = accounts;\n    if (!Array.isArray(finalAccounts)) {\n      log.error(\"MetaMask: Received non-array accounts parameter. Please report this bug.\", finalAccounts);\n      finalAccounts = [];\n    }\n\n    for (const account of accounts) {\n      if (typeof account !== \"string\") {\n        log.error(\"MetaMask: Received non-string account. Please report this bug.\", accounts);\n        finalAccounts = [];\n        break;\n      }\n    }\n\n    // emit accountsChanged if anything about the accounts array has changed\n    if (!dequal(this._state.accounts, finalAccounts)) {\n      // we should always have the correct accounts even before eth_accounts\n      // returns, except in cases where isInternal is true\n      if (isEthAccounts && Array.isArray(this._state.accounts) && this._state.accounts.length > 0 && !isInternal) {\n        log.error('MetaMask: \"eth_accounts\" unexpectedly updated accounts. Please report this bug.', finalAccounts);\n      }\n\n      this._state.accounts = finalAccounts as string[];\n      this.emit(\"accountsChanged\", finalAccounts);\n    }\n\n    // handle selectedAddress\n    if (this.selectedAddress !== finalAccounts[0]) {\n      this.selectedAddress = (finalAccounts[0] as string) || null;\n    }\n  }\n\n  /**\n   * Upon receipt of a new chainId and networkVersion, emits corresponding\n   * events and sets relevant public state.\n   * Does nothing if neither the chainId nor the networkVersion are different\n   * from existing values.\n   *\n   * emits MetamaskInpageProvider#chainChanged\n   * @param networkInfo - An object with network info.\n   */\n  protected _handleChainChanged({ chainId, networkVersion }: { chainId?: string; networkVersion?: string } = {}): void {\n    if (!chainId || !networkVersion) {\n      log.error(\"MetaMask: Received invalid network parameters. Please report this bug.\", { chainId, networkVersion });\n      return;\n    }\n\n    if (networkVersion === \"loading\") {\n      this._handleDisconnect(true);\n    } else {\n      this._handleConnect(chainId);\n\n      if (chainId !== this.chainId) {\n        this.chainId = chainId;\n        if (this._state.initialized) {\n          this.emit(\"chainChanged\", this.chainId);\n        }\n      }\n    }\n  }\n\n  /**\n   * Upon receipt of a new isUnlocked state, sets relevant public state.\n   * Calls the accounts changed handler with the received accounts, or an empty\n   * array.\n   *\n   * Does nothing if the received value is equal to the existing value.\n   * There are no lock/unlock events.\n   *\n   * @param opts - Options bag.\n   */\n  protected _handleUnlockStateChanged({ accounts, isUnlocked }: { accounts?: string[]; isUnlocked?: boolean } = {}): void {\n    if (typeof isUnlocked !== \"boolean\") {\n      log.error(\"MetaMask: Received invalid isUnlocked parameter. Please report this bug.\", { isUnlocked });\n      return;\n    }\n\n    if (isUnlocked !== this._state.isUnlocked) {\n      this._state.isUnlocked = isUnlocked;\n      this._handleAccountsChanged(accounts || []);\n    }\n  }\n\n  /**\n   * Warns of deprecation for the given event, if applicable.\n   */\n  protected _warnOfDeprecation(eventName: string): void {\n    if (this._sentWarnings.events[eventName] === false) {\n      log.warn(messages.warnings.events[eventName]);\n      this._sentWarnings.events[eventName] = true;\n    }\n  }\n}\n\nexport default TorusInpageProvider;\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"create-hash\");","import createHash from \"create-hash\";\n\nimport { IHashAlgorithmOptions, SRI } from \"./interfaces\";\n\nconst defaults = (options: IHashAlgorithmOptions) => ({\n  algorithms: options.algorithms || [\"sha256\"],\n  delimiter: options.delimiter || \" \",\n  full: options.full || false,\n});\n\n// Generate list of hashes\nconst hashes = (options: IHashAlgorithmOptions, data: string): Record<createHash.algorithm, string> => {\n  const internalHashes: Record<string, string> = {};\n  options.algorithms.forEach((algorithm) => {\n    internalHashes[algorithm] = createHash(algorithm).update(data, \"utf8\").digest(\"base64\");\n  });\n  return internalHashes;\n};\n// Build an integrity string\nconst integrity = (options: IHashAlgorithmOptions, sri: SRI): string => {\n  let output = \"\";\n\n  // Hash list\n  output += Object.keys(sri.hashes)\n    .map((algorithm: createHash.algorithm) => `${algorithm}-${sri.hashes[algorithm]}`)\n    .join(options.delimiter);\n\n  return output;\n};\n\nconst main = (options: IHashAlgorithmOptions, data: string): SRI | string => {\n  // Defaults\n  const finalOptions = defaults(options);\n\n  const sri = {\n    hashes: hashes(finalOptions, data),\n    integrity: undefined,\n  };\n  sri.integrity = integrity(finalOptions, sri);\n\n  return finalOptions.full ? sri : sri.integrity;\n};\n\nexport default main;\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"events\");","import { EventEmitter } from \"events\";\n\nimport { getPopupFeatures } from \"./utils\";\n\nclass PopupHandler extends EventEmitter {\n  url: URL;\n\n  target: string;\n\n  features: string;\n\n  window: Window;\n\n  windowTimer: number;\n\n  iClosedWindow: boolean;\n\n  constructor({ url, target, features }: { url: URL; target?: string; features?: string }) {\n    super();\n    this.url = url;\n    this.target = target || \"_blank\";\n    this.features = features || getPopupFeatures();\n    this.window = undefined;\n    this.windowTimer = undefined;\n    this.iClosedWindow = false;\n    this._setupTimer();\n  }\n\n  _setupTimer(): void {\n    this.windowTimer = Number(\n      setInterval(() => {\n        if (this.window && this.window.closed) {\n          clearInterval(this.windowTimer);\n          if (!this.iClosedWindow) {\n            this.emit(\"close\");\n          }\n          this.iClosedWindow = false;\n          this.window = undefined;\n        }\n        if (this.window === undefined) clearInterval(this.windowTimer);\n      }, 500)\n    );\n  }\n\n  open(): Promise<void> {\n    this.window = window.open(this.url.href, this.target, this.features);\n    if (this.window?.focus) this.window.focus();\n    return Promise.resolve();\n  }\n\n  close(): void {\n    this.iClosedWindow = true;\n    if (this.window) this.window.close();\n  }\n\n  redirect(locationReplaceOnRedirect: boolean): void {\n    if (locationReplaceOnRedirect) {\n      window.location.replace(this.url.href);\n    } else {\n      window.location.href = this.url.href;\n    }\n  }\n}\n\nexport default PopupHandler;\n","import { JRPCEngine } from \"@toruslabs/openlogin-jrpc\";\n\nimport log from \"./loglevel\";\nimport messages from \"./messages\";\nimport { getPreopenInstanceId, NOOP } from \"./utils\";\n\n/**\n * Returns whether the given image URL exists\n * @param url - the url of the image\n * @returns - whether the image exists\n */\nfunction imgExists(url: string): Promise<boolean> {\n  return new Promise((resolve, reject) => {\n    try {\n      const img = document.createElement(\"img\");\n      img.onload = () => resolve(true);\n      img.onerror = () => resolve(false);\n      img.src = url;\n    } catch (e) {\n      reject(e);\n    }\n  });\n}\n\n/**\n * Extracts a name for the site from the DOM\n */\nconst getSiteName = (window: Window) => {\n  const { document } = window;\n\n  const siteName = document.querySelector<HTMLMetaElement>('head > meta[property=\"og:site_name\"]');\n  if (siteName) {\n    return siteName.content;\n  }\n\n  const metaTitle = document.querySelector<HTMLMetaElement>('head > meta[name=\"title\"]');\n  if (metaTitle) {\n    return metaTitle.content;\n  }\n\n  if (document.title && document.title.length > 0) {\n    return document.title;\n  }\n\n  return window.location.hostname;\n};\n\n/**\n * Extracts an icon for the site from the DOM\n */\nasync function getSiteIcon(window: Window): Promise<string | null> {\n  const { document } = window;\n\n  // Use the site's favicon if it exists\n  let icon = document.querySelector<HTMLLinkElement>('head > link[rel=\"shortcut icon\"]');\n  if (icon && (await imgExists(icon.href))) {\n    return icon.href;\n  }\n\n  // Search through available icons in no particular order\n  icon = Array.from(document.querySelectorAll<HTMLLinkElement>('head > link[rel=\"icon\"]')).find((_icon) => Boolean(_icon.href));\n  if (icon && (await imgExists(icon.href))) {\n    return icon.href;\n  }\n\n  return null;\n}\n\n/**\n * Gets site metadata and returns it\n *\n */\nconst getSiteMetadata = async () => ({\n  name: getSiteName(window),\n  icon: await getSiteIcon(window),\n});\n\n/**\n * Sends site metadata over an RPC request.\n */\nexport default async function sendSiteMetadata(engine: JRPCEngine): Promise<void> {\n  try {\n    const domainMetadata = await getSiteMetadata();\n    // call engine.handle directly to avoid normal RPC request handling\n    engine.handle(\n      {\n        jsonrpc: \"2.0\",\n        id: getPreopenInstanceId(),\n        method: \"wallet_sendDomainMetadata\",\n        params: domainMetadata,\n      },\n      NOOP\n    );\n  } catch (error) {\n    log.error({\n      message: messages.errors.sendSiteMetadata(),\n      originalError: error,\n    });\n  }\n}\n","import NodeDetailManager from \"@toruslabs/fetch-node-details\";\nimport { setAPIKey } from \"@toruslabs/http-helpers\";\nimport { BasePostMessageStream, JRPCRequest, ObjectMultiplex, setupMultiplex, Substream } from \"@toruslabs/openlogin-jrpc\";\nimport TorusJs from \"@toruslabs/torus.js\";\nimport deepmerge from \"lodash.merge\";\n\nimport configuration from \"./config\";\nimport { documentReady, handleStream, htmlToElement, runOnLoad } from \"./embedUtils\";\nimport TorusInpageProvider from \"./inpage-provider\";\nimport generateIntegrity from \"./integrity\";\nimport {\n  BUTTON_POSITION,\n  BUTTON_POSITION_TYPE,\n  EMBED_TRANSLATION_ITEM,\n  LOGIN_PROVIDER,\n  PAYMENT_PROVIDER_TYPE,\n  PaymentParams,\n  TORUS_BUILD_ENV,\n  TorusCtorArgs,\n  TorusLoginParams,\n  TorusParams,\n  TorusPublicKey,\n  UnvalidatedJsonRpcRequest,\n  UserInfo,\n  VerifierArgs,\n  WALLET_OPENLOGIN_VERIFIER_MAP,\n  WALLET_PATH,\n  WhiteLabelParams,\n} from \"./interfaces\";\nimport log from \"./loglevel\";\nimport PopupHandler from \"./PopupHandler\";\nimport sendSiteMetadata from \"./siteMetadata\";\nimport {\n  FEATURES_CONFIRM_WINDOW,\n  FEATURES_DEFAULT_WALLET_WINDOW,\n  FEATURES_PROVIDER_CHANGE_WINDOW,\n  getPreopenInstanceId,\n  getTorusUrl,\n  getUserLanguage,\n  storageAvailable,\n  validatePaymentProvider,\n} from \"./utils\";\n\nconst defaultVerifiers = {\n  [LOGIN_PROVIDER.GOOGLE]: true,\n  [LOGIN_PROVIDER.FACEBOOK]: true,\n  [LOGIN_PROVIDER.REDDIT]: true,\n  [LOGIN_PROVIDER.TWITCH]: true,\n  [LOGIN_PROVIDER.DISCORD]: true,\n};\n\nconst iframeIntegrity = \"sha384-FLPj0jKrb6vIli62Ed4n/sqWhdhHMpFz3NffAV4H8uqTkzPsf4IAtKFgeVGgxb4+\";\n\nconst expectedCacheControlHeader = \"max-age=3600\";\n\nconst UNSAFE_METHODS = [\n  \"eth_sendTransaction\",\n  \"eth_signTypedData\",\n  \"eth_signTypedData_v3\",\n  \"eth_signTypedData_v4\",\n  \"personal_sign\",\n  \"eth_getEncryptionPublicKey\",\n  \"eth_decrypt\",\n];\n\nconst isLocalStorageAvailable = storageAvailable(\"localStorage\");\n\n// preload for iframe doesn't work https://bugs.chromium.org/p/chromium/issues/detail?id=593267\n(async function preLoadIframe() {\n  try {\n    if (typeof document === \"undefined\") return;\n    const torusIframeHtml = document.createElement(\"link\");\n    const { torusUrl } = await getTorusUrl(\"production\", { check: false, hash: iframeIntegrity, version: \"\" });\n    torusIframeHtml.href = `${torusUrl}/popup`;\n    torusIframeHtml.crossOrigin = \"anonymous\";\n    torusIframeHtml.type = \"text/html\";\n    torusIframeHtml.rel = \"prefetch\";\n    if (torusIframeHtml.relList && torusIframeHtml.relList.supports) {\n      if (torusIframeHtml.relList.supports(\"prefetch\")) {\n        document.head.appendChild(torusIframeHtml);\n      }\n    }\n  } catch (error) {\n    log.warn(error);\n  }\n})();\n\nclass Torus {\n  buttonPosition: BUTTON_POSITION_TYPE = BUTTON_POSITION.BOTTOM_LEFT;\n\n  torusUrl: string;\n\n  torusIframe: HTMLIFrameElement;\n\n  styleLink: HTMLLinkElement;\n\n  isLoggedIn: boolean;\n\n  isInitialized: boolean;\n\n  torusWidgetVisibility: boolean;\n\n  torusAlert: HTMLDivElement;\n\n  nodeDetailManager: NodeDetailManager;\n\n  torusJs: TorusJs;\n\n  apiKey: string;\n\n  modalZIndex: number;\n\n  alertZIndex: number;\n\n  torusAlertContainer: HTMLDivElement;\n\n  isIframeFullScreen: boolean;\n\n  whiteLabel: WhiteLabelParams;\n\n  requestedVerifier: string;\n\n  currentVerifier: string;\n\n  embedTranslations: EMBED_TRANSLATION_ITEM;\n\n  ethereum: TorusInpageProvider;\n\n  provider: TorusInpageProvider;\n\n  communicationMux: ObjectMultiplex;\n\n  isLoginCallback: () => void;\n\n  dappStorageKey: string;\n\n  paymentProviders = configuration.paymentProviders;\n\n  private loginHint = \"\";\n\n  private useWalletConnect: boolean;\n\n  constructor({ buttonPosition = BUTTON_POSITION.BOTTOM_LEFT, modalZIndex = 99999, apiKey = \"torus-default\" }: TorusCtorArgs = {}) {\n    this.buttonPosition = buttonPosition;\n    this.torusUrl = \"\";\n    this.isLoggedIn = false; // ethereum.enable working\n    this.isInitialized = false; // init done\n    this.torusWidgetVisibility = true;\n    this.requestedVerifier = \"\";\n    this.currentVerifier = \"\";\n    this.nodeDetailManager = new NodeDetailManager();\n    this.torusJs = new TorusJs({\n      metadataHost: \"https://metadata.tor.us\",\n      allowHost: \"https://signer.tor.us/api/allow\",\n      network: \"mainnet\",\n    });\n    this.apiKey = apiKey;\n    TorusJs.setAPIKey(apiKey);\n    setAPIKey(apiKey);\n    this.modalZIndex = modalZIndex;\n    this.alertZIndex = modalZIndex + 1000;\n    this.isIframeFullScreen = false;\n    this.dappStorageKey = \"\";\n  }\n\n  async init({\n    buildEnv = TORUS_BUILD_ENV.PRODUCTION,\n    enableLogging = false,\n    // deprecated: use loginConfig instead\n    enabledVerifiers = defaultVerifiers,\n    network = {\n      host: \"mainnet\",\n      chainId: null,\n      networkName: \"\",\n      blockExplorer: \"\",\n      ticker: \"\",\n      tickerName: \"\",\n    },\n    loginConfig = {},\n    showTorusButton = true,\n    integrity = {\n      check: false,\n      hash: iframeIntegrity,\n      version: \"\",\n    },\n    whiteLabel,\n    skipTKey = false,\n    useLocalStorage = false,\n    useWalletConnect = false,\n  }: TorusParams = {}): Promise<void> {\n    if (this.isInitialized) throw new Error(\"Already initialized\");\n    const { torusUrl, logLevel } = await getTorusUrl(buildEnv, integrity);\n    log.info(torusUrl, \"url loaded\");\n    this.torusUrl = torusUrl;\n    this.whiteLabel = whiteLabel;\n    this.useWalletConnect = useWalletConnect;\n    log.setDefaultLevel(logLevel);\n    if (enableLogging) log.enableAll();\n    else log.disableAll();\n    this.torusWidgetVisibility = showTorusButton;\n    let dappStorageKey = \"\";\n    if (isLocalStorageAvailable && useLocalStorage) {\n      const localStorageKey = `${configuration.localStorageKeyPrefix}${window.location.hostname}`;\n      const storedKey = window.localStorage.getItem(localStorageKey);\n      if (storedKey) dappStorageKey = storedKey;\n      else {\n        const generatedKey = `torus-app-${getPreopenInstanceId()}`;\n        window.localStorage.setItem(localStorageKey, generatedKey);\n        dappStorageKey = generatedKey;\n      }\n    }\n    this.dappStorageKey = dappStorageKey;\n    const torusIframeUrl = new URL(torusUrl);\n    if (torusIframeUrl.pathname.endsWith(\"/\")) torusIframeUrl.pathname += \"popup\";\n    else torusIframeUrl.pathname += \"/popup\";\n    if (dappStorageKey) {\n      torusIframeUrl.hash = `#dappStorageKey=${dappStorageKey}`;\n    }\n    // Iframe code\n    this.torusIframe = htmlToElement<HTMLIFrameElement>(\n      `<iframe\n        id=\"torusIframe\"\n        allow=${useWalletConnect ? \"camera\" : \"\"}\n        class=\"torusIframe\"\n        src=\"${torusIframeUrl.href}\"\n        style=\"display: none; position: fixed; top: 0; right: 0; width: 100%;\n        height: 100%; border: none; border-radius: 0; z-index: ${this.modalZIndex}\"\n      ></iframe>`\n    );\n\n    this.torusAlertContainer = htmlToElement<HTMLDivElement>('<div id=\"torusAlertContainer\"></div>');\n    this.torusAlertContainer.style.display = \"none\";\n    this.torusAlertContainer.style.setProperty(\"z-index\", this.alertZIndex.toString());\n\n    const link = window.document.createElement(\"link\");\n    link.setAttribute(\"rel\", \"stylesheet\");\n    link.setAttribute(\"type\", \"text/css\");\n    link.setAttribute(\"href\", `${torusUrl}/css/widget.css`);\n    this.styleLink = link;\n\n    const { defaultLanguage = getUserLanguage(), customTranslations = {} } = this.whiteLabel || {};\n    const mergedTranslations = deepmerge(configuration.translations, customTranslations);\n    const languageTranslations = mergedTranslations[defaultLanguage] || configuration.translations[getUserLanguage()];\n    this.embedTranslations = languageTranslations.embed;\n\n    const handleSetup = async () => {\n      await documentReady();\n      return new Promise((resolve, reject) => {\n        this.torusIframe.onload = async () => {\n          // only do this if iframe is not full screen\n          this._setupWeb3();\n          const initStream = this.communicationMux.getStream(\"init_stream\") as Substream;\n          initStream.on(\"data\", (chunk) => {\n            const { name, data, error } = chunk;\n            if (name === \"init_complete\" && data.success) {\n              // resolve promise\n              this.isInitialized = true;\n              this._displayIframe(this.isIframeFullScreen);\n              resolve(undefined);\n            } else if (error) {\n              reject(new Error(error));\n            }\n          });\n          initStream.write({\n            name: \"init_stream\",\n            data: {\n              enabledVerifiers,\n              loginConfig,\n              whiteLabel: this.whiteLabel,\n              buttonPosition: this.buttonPosition,\n              torusWidgetVisibility: this.torusWidgetVisibility,\n              apiKey: this.apiKey,\n              skipTKey,\n              network,\n            },\n          });\n        };\n        window.document.head.appendChild(this.styleLink);\n        window.document.body.appendChild(this.torusIframe);\n        window.document.body.appendChild(this.torusAlertContainer);\n      });\n    };\n\n    if (buildEnv === \"production\" && integrity.check) {\n      // hacky solution to check for iframe integrity\n      const fetchUrl = `${torusUrl}/popup`;\n      const resp = await fetch(fetchUrl, { cache: \"reload\" });\n      if (resp.headers.get(\"Cache-Control\") !== expectedCacheControlHeader) {\n        throw new Error(`Unexpected Cache-Control headers, got ${resp.headers.get(\"Cache-Control\")}`);\n      }\n      const response = await resp.text();\n      const calculatedIntegrity = generateIntegrity(\n        {\n          algorithms: [\"sha384\"],\n        },\n        response\n      );\n      log.info(calculatedIntegrity, \"integrity\");\n      if (calculatedIntegrity === integrity.hash) {\n        await handleSetup();\n      } else {\n        this.clearInit();\n        throw new Error(\"Integrity check failed\");\n      }\n    } else {\n      await handleSetup();\n    }\n    return undefined;\n  }\n\n  login({ verifier = \"\", login_hint: loginHint = \"\" }: TorusLoginParams = {}): Promise<string[]> {\n    if (!this.isInitialized) throw new Error(\"Call init() first\");\n    this.requestedVerifier = verifier;\n    this.loginHint = loginHint;\n    return this.ethereum.enable();\n  }\n\n  logout(): Promise<void> {\n    return new Promise((resolve, reject) => {\n      if (!this.isLoggedIn) {\n        reject(new Error(\"User has not logged in yet\"));\n        return;\n      }\n\n      const logOutStream = this.communicationMux.getStream(\"logout\") as Substream;\n      logOutStream.write({ name: \"logOut\" });\n      const statusStream = this.communicationMux.getStream(\"status\") as Substream;\n      const statusStreamHandler = (status) => {\n        if (!status.loggedIn) {\n          this.isLoggedIn = false;\n          this.currentVerifier = \"\";\n          this.requestedVerifier = \"\";\n          resolve();\n        } else reject(new Error(\"Some Error Occured\"));\n      };\n      handleStream(statusStream, \"data\", statusStreamHandler);\n    });\n  }\n\n  async cleanUp(): Promise<void> {\n    if (this.isLoggedIn) {\n      await this.logout();\n    }\n    this.clearInit();\n  }\n\n  clearInit(): void {\n    function isElement(element: unknown) {\n      return element instanceof Element || element instanceof HTMLDocument;\n    }\n    if (isElement(this.styleLink) && window.document.body.contains(this.styleLink)) {\n      this.styleLink.remove();\n      this.styleLink = undefined;\n    }\n    if (isElement(this.torusIframe) && window.document.body.contains(this.torusIframe)) {\n      this.torusIframe.remove();\n      this.torusIframe = undefined;\n    }\n    if (isElement(this.torusAlertContainer) && window.document.body.contains(this.torusAlertContainer)) {\n      this.torusAlert = undefined;\n      this.torusAlertContainer.remove();\n      this.torusAlertContainer = undefined;\n    }\n    this.isInitialized = false;\n  }\n\n  hideTorusButton(): void {\n    this.torusWidgetVisibility = false;\n    this._sendWidgetVisibilityStatus(false);\n    this._displayIframe();\n  }\n\n  showTorusButton(): void {\n    this.torusWidgetVisibility = true;\n    this._sendWidgetVisibilityStatus(true);\n    this._displayIframe();\n  }\n\n  setProvider({ host = \"mainnet\", chainId = null, networkName = \"\", ...rest } = {}): Promise<void> {\n    return new Promise((resolve, reject) => {\n      const providerChangeStream = this.communicationMux.getStream(\"provider_change\") as Substream;\n      const handler = (chunk) => {\n        const { err, success } = chunk.data;\n        log.info(chunk);\n        if (err) {\n          reject(err);\n        } else if (success) {\n          resolve();\n        } else reject(new Error(\"some error occured\"));\n      };\n      handleStream(providerChangeStream, \"data\", handler);\n      const preopenInstanceId = getPreopenInstanceId();\n      this._handleWindow(preopenInstanceId, {\n        target: \"_blank\",\n        features: FEATURES_PROVIDER_CHANGE_WINDOW,\n      });\n      providerChangeStream.write({\n        name: \"show_provider_change\",\n        data: {\n          network: {\n            host,\n            chainId,\n            networkName,\n            ...rest,\n          },\n          preopenInstanceId,\n          override: false,\n        },\n      });\n    });\n  }\n\n  showWallet(path: WALLET_PATH, params: Record<string, string> = {}): void {\n    const showWalletStream = this.communicationMux.getStream(\"show_wallet\") as Substream;\n    const finalPath = path ? `/${path}` : \"\";\n    showWalletStream.write({ name: \"show_wallet\", data: { path: finalPath } });\n\n    const showWalletHandler = (chunk) => {\n      if (chunk.name === \"show_wallet_instance\") {\n        // Let the error propogate up (hence, no try catch)\n        const { instanceId } = chunk.data;\n        const finalUrl = new URL(`${this.torusUrl}/wallet${finalPath}`);\n        // Using URL constructor to prevent js injection and allow parameter validation.!\n        finalUrl.searchParams.append(\"integrity\", \"true\");\n        finalUrl.searchParams.append(\"instanceId\", instanceId);\n        Object.keys(params).forEach((x) => {\n          finalUrl.searchParams.append(x, params[x]);\n        });\n        if (this.dappStorageKey) {\n          finalUrl.hash = `#dappStorageKey=${this.dappStorageKey}`;\n        }\n        const walletWindow = new PopupHandler({ url: finalUrl, features: FEATURES_DEFAULT_WALLET_WINDOW });\n        walletWindow.open();\n      }\n    };\n\n    handleStream(showWalletStream, \"data\", showWalletHandler);\n  }\n\n  async getPublicAddress({ verifier, verifierId, isExtended = false }: VerifierArgs): Promise<string | TorusPublicKey> {\n    if (!configuration.supportedVerifierList.includes(verifier) || !WALLET_OPENLOGIN_VERIFIER_MAP[verifier]) throw new Error(\"Unsupported verifier\");\n    const nodeDetails = await this.nodeDetailManager.getNodeDetails({ verifier, verifierId });\n    const endpoints = nodeDetails.torusNodeEndpoints;\n    const torusNodePubs = nodeDetails.torusNodePub;\n    const walletVerifier = verifier;\n    const openloginVerifier = WALLET_OPENLOGIN_VERIFIER_MAP[verifier];\n    try {\n      const existingV1User = await this.torusJs.getUserTypeAndAddress(endpoints, torusNodePubs, { verifier: walletVerifier, verifierId });\n      if (existingV1User.typeOfUser === \"v1\") {\n        if (!isExtended) return existingV1User.address;\n        return existingV1User;\n      }\n      // we don't support v2 users with v1 verifiers so get or assign the key for v2 user on v2 `verifier`\n      const v2User = await this.torusJs.getUserTypeAndAddress(endpoints, torusNodePubs, { verifier: openloginVerifier, verifierId }, true);\n      if (!isExtended) return v2User.address;\n      return v2User;\n    } catch (error) {\n      if (error?.message.includes(\"Verifier + VerifierID has not yet been assigned\")) {\n        // if user doesn't have key then assign it with v2 verifier\n        const newV2User = await this.torusJs.getUserTypeAndAddress(endpoints, torusNodePubs, { verifier: openloginVerifier, verifierId }, true);\n        if (!isExtended) return newV2User.address;\n        return newV2User;\n      }\n      throw error;\n    }\n  }\n\n  getUserInfo(message: string): Promise<UserInfo> {\n    return new Promise((resolve, reject) => {\n      if (this.isLoggedIn) {\n        const userInfoAccessStream = this.communicationMux.getStream(\"user_info_access\") as Substream;\n        userInfoAccessStream.write({ name: \"user_info_access_request\" });\n        const userInfoAccessHandler = (chunk) => {\n          const {\n            name,\n            data: { approved, payload, rejected, newRequest },\n          } = chunk;\n          if (name === \"user_info_access_response\") {\n            if (approved) {\n              resolve(payload);\n            } else if (rejected) {\n              reject(new Error(\"User rejected the request\"));\n            } else if (newRequest) {\n              const userInfoStream = this.communicationMux.getStream(\"user_info\") as Substream;\n              const userInfoHandler = (handlerChunk) => {\n                if (handlerChunk.name === \"user_info_response\") {\n                  if (handlerChunk.data.approved) {\n                    resolve(handlerChunk.data.payload);\n                  } else {\n                    reject(new Error(\"User rejected the request\"));\n                  }\n                }\n              };\n              handleStream(userInfoStream, \"data\", userInfoHandler);\n              const preopenInstanceId = getPreopenInstanceId();\n              this._handleWindow(preopenInstanceId, {\n                target: \"_blank\",\n                features: FEATURES_PROVIDER_CHANGE_WINDOW,\n              });\n              userInfoStream.write({ name: \"user_info_request\", data: { message, preopenInstanceId } });\n            }\n          }\n        };\n        handleStream(userInfoAccessStream, \"data\", userInfoAccessHandler);\n      } else reject(new Error(\"User has not logged in yet\"));\n    });\n  }\n\n  initiateTopup(provider: PAYMENT_PROVIDER_TYPE, params: PaymentParams): Promise<boolean> {\n    return new Promise((resolve, reject) => {\n      if (this.isInitialized) {\n        const { errors, isValid } = validatePaymentProvider(provider, params);\n        if (!isValid) {\n          reject(new Error(JSON.stringify(errors)));\n          return;\n        }\n        const topupStream = this.communicationMux.getStream(\"topup\") as Substream;\n        const topupHandler = (chunk) => {\n          if (chunk.name === \"topup_response\") {\n            if (chunk.data.success) {\n              resolve(chunk.data.success);\n            } else {\n              reject(new Error(chunk.data.error));\n            }\n          }\n        };\n        handleStream(topupStream, \"data\", topupHandler);\n        const preopenInstanceId = getPreopenInstanceId();\n        this._handleWindow(preopenInstanceId);\n        topupStream.write({ name: \"topup_request\", data: { provider, params, preopenInstanceId } });\n      } else reject(new Error(\"Torus is not initialized yet\"));\n    });\n  }\n\n  async loginWithPrivateKey(loginParams: { privateKey: string; userInfo: Omit<UserInfo, \"isNewUser\"> }): Promise<void> {\n    const { privateKey, userInfo } = loginParams;\n    return new Promise((resolve, reject) => {\n      if (this.isInitialized) {\n        if (Buffer.from(privateKey, \"hex\").length !== 32) {\n          reject(new Error(\"Invalid private key, Please provide a 32 byte valid secp25k1 private key\"));\n          return;\n        }\n        const loginPrivKeyStream = this.communicationMux.getStream(\"login_with_private_key\") as Substream;\n        const loginHandler = (chunk) => {\n          if (chunk.name === \"login_with_private_key_response\") {\n            if (chunk.data.success) {\n              resolve(chunk.data.success);\n            } else {\n              reject(new Error(chunk.data.error));\n            }\n          }\n        };\n        handleStream(loginPrivKeyStream, \"data\", loginHandler);\n        loginPrivKeyStream.write({ name: \"login_with_private_key_request\", data: { privateKey, userInfo } });\n      } else reject(new Error(\"Torus is not initialized yet\"));\n    });\n  }\n\n  async showWalletConnectScanner(): Promise<void> {\n    if (!this.useWalletConnect) throw new Error(\"Set `useWalletConnect` as true in init function options to use wallet connect scanner\");\n    return new Promise((resolve, reject) => {\n      if (this.isLoggedIn) {\n        const walletConnectStream = this.communicationMux.getStream(\"wallet_connect_stream\") as Substream;\n        const walletConnectHandler = (chunk) => {\n          if (chunk.name === \"wallet_connect_stream_res\") {\n            if (chunk.data.success) {\n              resolve(chunk.data.success);\n            } else {\n              reject(new Error(chunk.data.error));\n            }\n            this._displayIframe();\n          }\n        };\n        handleStream(walletConnectStream, \"data\", walletConnectHandler);\n        walletConnectStream.write({ name: \"wallet_connect_stream_req\" });\n        this._displayIframe(true);\n      } else reject(new Error(\"User has not logged in yet\"));\n    });\n  }\n\n  protected _handleWindow(preopenInstanceId: string, { url, target, features }: { url?: string; target?: string; features?: string } = {}): void {\n    if (preopenInstanceId) {\n      const windowStream = this.communicationMux.getStream(\"window\") as Substream;\n      const finalUrl = new URL(url || `${this.torusUrl}/redirect?preopenInstanceId=${preopenInstanceId}`);\n      if (this.dappStorageKey) {\n        // If multiple instances, it returns the first one\n        if (finalUrl.hash) finalUrl.hash += `&dappStorageKey=${this.dappStorageKey}`;\n        else finalUrl.hash = `#dappStorageKey=${this.dappStorageKey}`;\n      }\n      const handledWindow = new PopupHandler({ url: finalUrl, target, features });\n      handledWindow.open();\n      if (!handledWindow.window) {\n        this._createPopupBlockAlert(preopenInstanceId, finalUrl.href);\n        return;\n      }\n      windowStream.write({\n        name: \"opened_window\",\n        data: {\n          preopenInstanceId,\n        },\n      });\n      const closeHandler = ({ preopenInstanceId: receivedId, close }) => {\n        if (receivedId === preopenInstanceId && close) {\n          handledWindow.close();\n          windowStream.removeListener(\"data\", closeHandler);\n        }\n      };\n      windowStream.on(\"data\", closeHandler);\n      handledWindow.once(\"close\", () => {\n        windowStream.write({\n          data: {\n            preopenInstanceId,\n            closed: true,\n          },\n        });\n        windowStream.removeListener(\"data\", closeHandler);\n      });\n    }\n  }\n\n  protected _setEmbedWhiteLabel(element: HTMLElement): void {\n    // Set whitelabel\n    const { theme } = this.whiteLabel || {};\n    if (theme) {\n      const { isDark = false, colors = {} } = theme;\n      if (isDark) element.classList.add(\"torus-dark\");\n\n      if (colors.torusBrand1) element.style.setProperty(\"--torus-brand-1\", colors.torusBrand1);\n      if (colors.torusGray2) element.style.setProperty(\"--torus-gray-2\", colors.torusGray2);\n    }\n  }\n\n  protected _getLogoUrl(): string {\n    let logoUrl = `${this.torusUrl}/images/torus_icon-blue.svg`;\n    if (this.whiteLabel?.theme?.isDark) {\n      logoUrl = this.whiteLabel?.logoLight || logoUrl;\n    } else {\n      logoUrl = this.whiteLabel?.logoDark || logoUrl;\n    }\n\n    return logoUrl;\n  }\n\n  protected _sendWidgetVisibilityStatus(status: boolean): void {\n    const torusWidgetVisibilityStream = this.communicationMux.getStream(\"torus-widget-visibility\") as Substream;\n    torusWidgetVisibilityStream.write({\n      data: status,\n    });\n  }\n\n  protected _displayIframe(isFull = false): void {\n    const style: Partial<CSSStyleDeclaration> = {};\n    // set phase\n    if (!isFull) {\n      style.display = this.torusWidgetVisibility ? \"block\" : \"none\";\n      style.height = \"70px\";\n      style.width = \"70px\";\n      switch (this.buttonPosition) {\n        case BUTTON_POSITION.TOP_LEFT:\n          style.top = \"0px\";\n          style.left = \"0px\";\n          style.right = \"auto\";\n          style.bottom = \"auto\";\n          break;\n        case BUTTON_POSITION.TOP_RIGHT:\n          style.top = \"0px\";\n          style.right = \"0px\";\n          style.left = \"auto\";\n          style.bottom = \"auto\";\n          break;\n        case BUTTON_POSITION.BOTTOM_RIGHT:\n          style.bottom = \"0px\";\n          style.right = \"0px\";\n          style.top = \"auto\";\n          style.left = \"auto\";\n          break;\n        case BUTTON_POSITION.BOTTOM_LEFT:\n        default:\n          style.bottom = \"0px\";\n          style.left = \"0px\";\n          style.top = \"auto\";\n          style.right = \"auto\";\n          break;\n      }\n    } else {\n      style.display = \"block\";\n      style.width = \"100%\";\n      style.height = \"100%\";\n      style.top = \"0px\";\n      style.right = \"0px\";\n      style.left = \"0px\";\n      style.bottom = \"0px\";\n    }\n    Object.assign(this.torusIframe.style, style);\n    this.isIframeFullScreen = isFull;\n  }\n\n  protected _setupWeb3(): void {\n    log.info(\"setupWeb3 running\");\n    // setup background connection\n    const metamaskStream = new BasePostMessageStream({\n      name: \"embed_metamask\",\n      target: \"iframe_metamask\",\n      targetWindow: this.torusIframe.contentWindow,\n      targetOrigin: new URL(this.torusUrl).origin,\n    });\n\n    // Due to compatibility reasons, we should not set up multiplexing on window.metamaskstream\n    // because the MetamaskInpageProvider also attempts to do so.\n    // We create another LocalMessageDuplexStream for communication between dapp <> iframe\n    const communicationStream = new BasePostMessageStream({\n      name: \"embed_comm\",\n      target: \"iframe_comm\",\n      targetWindow: this.torusIframe.contentWindow,\n      targetOrigin: new URL(this.torusUrl).origin,\n    });\n\n    // Backward compatibility with Gotchi :)\n    // window.metamaskStream = this.communicationStream\n\n    // compose the inpage provider\n    const inpageProvider = new TorusInpageProvider(metamaskStream);\n\n    // detect eth_requestAccounts and pipe to enable for now\n    const detectAccountRequestPrototypeModifier = (m) => {\n      const originalMethod = inpageProvider[m];\n      inpageProvider[m] = function providerFunc(method, ...args) {\n        if (method && method === \"eth_requestAccounts\") {\n          return inpageProvider.enable();\n        }\n        return originalMethod.apply(this, [method, ...args]);\n      };\n    };\n\n    detectAccountRequestPrototypeModifier(\"send\");\n    detectAccountRequestPrototypeModifier(\"sendAsync\");\n\n    inpageProvider.enable = () => {\n      return new Promise((resolve, reject) => {\n        // If user is already logged in, we assume they have given access to the website\n        inpageProvider.sendAsync({ jsonrpc: \"2.0\", id: getPreopenInstanceId(), method: \"eth_requestAccounts\", params: [] }, (err, response) => {\n          const { result: res } = (response as { result: unknown }) || {};\n          if (err) {\n            setTimeout(() => {\n              reject(err);\n            }, 50);\n          } else if (Array.isArray(res) && res.length > 0) {\n            // If user is already rehydrated, resolve this\n            // else wait for something to be written to status stream\n            const handleLoginCb = () => {\n              if (this.requestedVerifier !== \"\" && this.currentVerifier !== this.requestedVerifier) {\n                const { requestedVerifier } = this;\n                // eslint-disable-next-line promise/no-promise-in-callback\n                this.logout()\n                  // eslint-disable-next-line promise/always-return\n                  .then((_) => {\n                    this.requestedVerifier = requestedVerifier;\n                    this._showLoginPopup(true, resolve, reject);\n                  })\n                  .catch((error) => reject(error));\n              } else {\n                resolve(res);\n              }\n            };\n            if (this.isLoggedIn) {\n              handleLoginCb();\n            } else {\n              this.isLoginCallback = handleLoginCb;\n            }\n          } else {\n            // set up listener for login\n            this._showLoginPopup(true, resolve, reject);\n          }\n        });\n      });\n    };\n\n    inpageProvider.tryPreopenHandle = (payload: UnvalidatedJsonRpcRequest | UnvalidatedJsonRpcRequest[], cb: (...args: unknown[]) => void) => {\n      const _payload = payload;\n      if (!Array.isArray(_payload) && UNSAFE_METHODS.includes(_payload.method)) {\n        const preopenInstanceId = getPreopenInstanceId();\n        this._handleWindow(preopenInstanceId, {\n          target: \"_blank\",\n          features: FEATURES_CONFIRM_WINDOW,\n        });\n        _payload.preopenInstanceId = preopenInstanceId;\n      }\n      inpageProvider._rpcEngine.handle(_payload as JRPCRequest<unknown>[], cb);\n    };\n\n    // Work around for web3@1.0 deleting the bound `sendAsync` but not the unbound\n    // `sendAsync` method on the prototype, causing `this` reference issues with drizzle\n    const proxiedInpageProvider = new Proxy(inpageProvider, {\n      // straight up lie that we deleted the property so that it doesnt\n      // throw an error in strict mode\n      deleteProperty: () => true,\n    });\n\n    this.ethereum = proxiedInpageProvider;\n    const communicationMux = setupMultiplex(communicationStream);\n\n    this.communicationMux = communicationMux;\n\n    const windowStream = communicationMux.getStream(\"window\") as Substream;\n    windowStream.on(\"data\", (chunk) => {\n      if (chunk.name === \"create_window\") {\n        // url is the url we need to open\n        // we can pass the final url upfront so that it removes the step of redirecting to /redirect and waiting for finalUrl\n        this._createPopupBlockAlert(chunk.data.preopenInstanceId, chunk.data.url);\n      }\n    });\n\n    // show torus widget if button clicked\n    const widgetStream = communicationMux.getStream(\"widget\") as Substream;\n    widgetStream.on(\"data\", (chunk) => {\n      const { data } = chunk;\n      this._displayIframe(data);\n    });\n\n    // Show torus button if wallet has been hydrated/detected\n    const statusStream = communicationMux.getStream(\"status\") as Substream;\n    statusStream.on(\"data\", (status) => {\n      // login\n      if (status.loggedIn) {\n        this.isLoggedIn = status.loggedIn;\n        this.currentVerifier = status.verifier;\n      } // logout\n      else this._displayIframe();\n      if (this.isLoginCallback) {\n        this.isLoginCallback();\n        delete this.isLoginCallback;\n      }\n    });\n\n    this.provider = proxiedInpageProvider;\n\n    if (this.provider.shouldSendMetadata) sendSiteMetadata(this.provider._rpcEngine);\n    inpageProvider._initializeState();\n    log.debug(\"Torus - injected provider\");\n  }\n\n  protected _showLoginPopup(calledFromEmbed: boolean, resolve: (a: string[]) => void, reject: (err: Error) => void): void {\n    const loginHandler = (data) => {\n      const { err, selectedAddress } = data;\n      if (err) {\n        log.error(err);\n        if (reject) reject(err);\n      }\n      // returns an array (cause accounts expects it)\n      else if (resolve) resolve([selectedAddress]);\n      if (this.isIframeFullScreen) this._displayIframe();\n    };\n    const oauthStream = this.communicationMux.getStream(\"oauth\") as Substream;\n    if (!this.requestedVerifier) {\n      this._displayIframe(true);\n      handleStream(oauthStream, \"data\", loginHandler);\n      oauthStream.write({ name: \"oauth_modal\", data: { calledFromEmbed } });\n    } else {\n      handleStream(oauthStream, \"data\", loginHandler);\n      const preopenInstanceId = getPreopenInstanceId();\n      this._handleWindow(preopenInstanceId);\n      oauthStream.write({\n        name: \"oauth\",\n        data: { calledFromEmbed, verifier: this.requestedVerifier, preopenInstanceId, login_hint: this.loginHint },\n      });\n    }\n  }\n\n  protected _createPopupBlockAlert(preopenInstanceId: string, url: string): void {\n    const logoUrl = this._getLogoUrl();\n    const torusAlert = htmlToElement<HTMLDivElement>(\n      '<div id=\"torusAlert\" class=\"torus-alert--v2\">' +\n        `<div id=\"torusAlert__logo\"><img src=\"${logoUrl}\" /></div>` +\n        \"<div>\" +\n        `<h1 id=\"torusAlert__title\">${this.embedTranslations.actionRequired}</h1>` +\n        `<p id=\"torusAlert__desc\">${this.embedTranslations.pendingAction}</p>` +\n        \"</div>\" +\n        \"</div>\"\n    );\n\n    const successAlert = htmlToElement(`<div><a id=\"torusAlert__btn\">${this.embedTranslations.continue}</a></div>`);\n    const btnContainer = htmlToElement('<div id=\"torusAlert__btn-container\"></div>');\n    btnContainer.appendChild(successAlert);\n    torusAlert.appendChild(btnContainer);\n    const bindOnLoad = () => {\n      successAlert.addEventListener(\"click\", () => {\n        this._handleWindow(preopenInstanceId, {\n          url,\n          target: \"_blank\",\n          features: FEATURES_CONFIRM_WINDOW,\n        });\n        torusAlert.remove();\n\n        if (this.torusAlertContainer.children.length === 0) this.torusAlertContainer.style.display = \"none\";\n      });\n    };\n\n    this._setEmbedWhiteLabel(torusAlert);\n\n    const attachOnLoad = () => {\n      this.torusAlertContainer.style.display = \"block\";\n      this.torusAlertContainer.appendChild(torusAlert);\n    };\n\n    runOnLoad(attachOnLoad);\n    runOnLoad(bindOnLoad);\n  }\n}\n\nexport default Torus;\n","export { default } from \"./embed\";\nexport { default as TorusInpageProvider } from \"./inpage-provider\";\nexport * from \"./interfaces\";\n"],"names":["LOGIN_PROVIDER","GOOGLE","FACEBOOK","TWITCH","REDDIT","DISCORD","WALLET_VERIFIERS","EMAIL_PASSWORDLESS","WALLET_OPENLOGIN_VERIFIER_MAP","PAYMENT_PROVIDER","MOONPAY","WYRE","RAMPNETWORK","XANPOOL","MERCURYO","TRANSAK","SUPPORTED_PAYMENT_NETWORK","MAINNET","MATIC","BSC_MAINNET","AVALANCHE_MAINNET","XDAI","TORUS_BUILD_ENV","PRODUCTION","DEVELOPMENT","BINANCE","TESTING","LRC","BETA","BUTTON_POSITION","BOTTOM_LEFT","TOP_LEFT","BOTTOM_RIGHT","TOP_RIGHT","CRYPTO_COMPARE_CURRENCIES","PROVIDER_SUPPORTED_FIAT_CURRENCIES","cryptoCompareCurrenciesSet","Set","supportedFiatCurrencies","provider","providerSupportedFiatCurrencies","filter","currency","has","paymentProviders","line1","line2","line3","supportPage","minOrderValue","maxOrderValue","validCurrencies","validCryptoCurrenciesByChain","value","display","includeFees","api","enforceMax","receiveHint","sell","translations","en","embed","continue","actionRequired","pendingAction","cookiesRequired","enableCookies","clickHere","de","ja","ko","zh","supportedVerifierList","Object","values","prodTorusUrl","localStorageKeyPrefix","runOnLoad","fn","Promise","resolve","reject","window","document","body","then","catch","addEventListener","runOnComplete","retry","setInterval","readyState","clearInterval","htmlToElement","html","template","createElement","trimmedHtml","trim","innerHTML","content","firstChild","handleEvent","handle","eventName","handler","handlerArgs","handlerWrapper","removeEventListener","handleStream","chunk","removeListener","on","documentReady","loglevel","getLogger","errors","disconnected","permanentlyDisconnected","sendSiteMetadata","unsupportedSync","method","invalidDuplexStream","invalidOptions","maxEventListeners","shouldSendMetadata","invalidRequestArgs","invalidRequestMethod","invalidRequestParams","invalidLoggerObject","invalidLoggerMethod","info","connected","chainId","warnings","enableDeprecation","sendDeprecation","events","close","data","networkChanged","notification","publicConfigStore","get","ethErrors","config","log","validatePaymentProvider","params","isValid","keys","length","selectedProvider","selectedParams","fiatValue","requestedOrderAmount","parseFloat","toString","selectedCurrency","includes","selectedCryptoCurrency","flat","map","finalCryptoCurrency","toLowerCase","createErrorMiddleware","req","res","next","error","rpc","invalidRequest","message","done","getRpcPromiseCallback","unwrapResult","response","Array","isArray","result","logStreamDisconnectWarning","remoteLabel","emitter","warningMsg","stack","warn","listenerCount","emit","getPreopenInstanceId","Math","random","slice","getTorusUrl","buildEnv","integrity","torusUrl","logLevel","version","process","env","TORUS_EMBED_VERSION","versionUsed","useAPIKey","getUserLanguage","userLanguage","navigator","language","userLanguages","split","prototype","hasOwnProperty","call","EMITTED_NOTIFICATIONS","NOOP","FEATURES_PROVIDER_CHANGE_WINDOW","FEATURES_DEFAULT_WALLET_WINDOW","FEATURES_DEFAULT_POPUP_WINDOW","FEATURES_CONFIRM_WINDOW","storageAvailable","type","storage","x","setItem","removeItem","e","code","name","getPopupFeatures","dualScreenLeft","screenLeft","undefined","screenX","dualScreenTop","screenTop","screenY","w","h","width","innerWidth","documentElement","clientWidth","screen","height","innerHeight","clientHeight","systemZoom","left","abs","top","features","ObservableStore","storeAsStream","createIdRemapMiddleware","createStreamMiddleware","JRPCEngine","ObjectMultiplex","SafeEventEmitter","EthereumRpcError","dequal","duplex","isDuplexStream","pump","messages","defaultMaxListeners","TorusInpageProvider","constructor","connectionStream","jsonRpcStreamName","enable","experimentalMethods","send","Error","isTorus","setMaxListeners","_state","_defaultState","selectedAddress","networkVersion","_handleAccountsChanged","bind","_handleChainChanged","_handleUnlockStateChanged","_handleConnect","_handleDisconnect","_handleStreamDisconnect","_sendSync","_rpcRequest","_warnOfDeprecation","_initializeState","request","sendAsync","mux","_publicConfigStore","storageKey","createStream","ignoreStream","isConnected","jsonRpcConnection","stream","rpcEngine","push","middleware","_rpcEngine","payload","_sentWarnings","args","callback","addListener","listener","once","prependListener","prependOnceListener","accounts","isUnlocked","initialized","isInternal","cb","_payload","jsonrpc","err","tryPreopenHandle","methodOrPayload","callbackOrArgs","id","debug","isRecoverable","errorMessage","isPermanentlyDisconnected","streamName","isEthAccounts","finalAccounts","account","hasEmittedConnection","createHash","defaults","options","algorithms","delimiter","full","hashes","internalHashes","forEach","algorithm","update","digest","sri","output","join","main","finalOptions","EventEmitter","PopupHandler","url","target","windowTimer","iClosedWindow","_setupTimer","Number","closed","open","href","focus","redirect","locationReplaceOnRedirect","location","replace","imgExists","img","onload","onerror","src","getSiteName","siteName","querySelector","metaTitle","title","hostname","getSiteIcon","icon","from","querySelectorAll","find","_icon","Boolean","getSiteMetadata","engine","domainMetadata","originalError","NodeDetailManager","setAPIKey","BasePostMessageStream","setupMultiplex","TorusJs","deepmerge","configuration","generateIntegrity","defaultVerifiers","iframeIntegrity","expectedCacheControlHeader","UNSAFE_METHODS","isLocalStorageAvailable","preLoadIframe","torusIframeHtml","check","hash","crossOrigin","rel","relList","supports","head","appendChild","Torus","buttonPosition","modalZIndex","apiKey","isLoggedIn","isInitialized","torusWidgetVisibility","requestedVerifier","currentVerifier","nodeDetailManager","torusJs","metadataHost","allowHost","network","alertZIndex","isIframeFullScreen","dappStorageKey","init","enableLogging","enabledVerifiers","host","networkName","blockExplorer","ticker","tickerName","loginConfig","showTorusButton","whiteLabel","skipTKey","useLocalStorage","useWalletConnect","setDefaultLevel","enableAll","disableAll","localStorageKey","storedKey","localStorage","getItem","generatedKey","torusIframeUrl","URL","pathname","endsWith","torusIframe","torusAlertContainer","style","setProperty","link","setAttribute","styleLink","defaultLanguage","customTranslations","mergedTranslations","languageTranslations","embedTranslations","handleSetup","_setupWeb3","initStream","communicationMux","getStream","success","_displayIframe","write","fetchUrl","resp","fetch","cache","headers","text","calculatedIntegrity","clearInit","login","verifier","login_hint","loginHint","ethereum","logout","logOutStream","statusStream","statusStreamHandler","status","loggedIn","cleanUp","isElement","element","Element","HTMLDocument","contains","remove","torusAlert","hideTorusButton","_sendWidgetVisibilityStatus","setProvider","rest","providerChangeStream","preopenInstanceId","_handleWindow","override","showWallet","path","showWalletStream","finalPath","showWalletHandler","instanceId","finalUrl","searchParams","append","walletWindow","getPublicAddress","verifierId","isExtended","nodeDetails","getNodeDetails","endpoints","torusNodeEndpoints","torusNodePubs","torusNodePub","walletVerifier","openloginVerifier","existingV1User","getUserTypeAndAddress","typeOfUser","address","v2User","newV2User","getUserInfo","userInfoAccessStream","userInfoAccessHandler","approved","rejected","newRequest","userInfoStream","userInfoHandler","handlerChunk","initiateTopup","JSON","stringify","topupStream","topupHandler","loginWithPrivateKey","loginParams","privateKey","userInfo","Buffer","loginPrivKeyStream","loginHandler","showWalletConnectScanner","walletConnectStream","walletConnectHandler","windowStream","handledWindow","_createPopupBlockAlert","closeHandler","receivedId","_setEmbedWhiteLabel","theme","isDark","colors","classList","add","torusBrand1","torusGray2","_getLogoUrl","logoUrl","logoLight","logoDark","torusWidgetVisibilityStream","isFull","right","bottom","assign","metamaskStream","targetWindow","contentWindow","targetOrigin","origin","communicationStream","inpageProvider","detectAccountRequestPrototypeModifier","m","originalMethod","providerFunc","apply","setTimeout","handleLoginCb","_","_showLoginPopup","isLoginCallback","proxiedInpageProvider","Proxy","deleteProperty","widgetStream","calledFromEmbed","oauthStream","successAlert","btnContainer","bindOnLoad","children","attachOnLoad","default"],"sourceRoot":""}